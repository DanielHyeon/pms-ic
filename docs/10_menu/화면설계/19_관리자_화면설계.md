# 19. 관리자 화면설계 (프로젝트 설정 + 시스템 설정)

> 작성일: 2026-02-08
> 버전: v2.1
> 라우트: `/admin/project` (프로젝트 설정), `/admin/system` (시스템 설정)
> 필요 Capability: `admin_project_view` (프로젝트 설정 조회), `admin_project_edit_general` / `admin_project_manage_parts` / `admin_project_manage_phases` / `admin_project_manage_role_matrix` / `admin_project_manage_workflow` / `admin_project_manage_notifications` (프로젝트 설정 편집), `admin_system` (시스템 설정), `admin_models` (모델 관리)
> 기본 Preset: `PM_WORK` (프로젝트 설정), `ADMIN_OPS` (시스템 설정)
> 노드 역할: **Action** (액션 노드 — 설정/변경/관리 전용)

---

## 1. 화면 개요

### 1.1 목적

관리자 화면은 **"프로젝트와 시스템을 어떻게 구성하고 운영할 것인가?"**에 대한 답을 제공한다.
기존 분산된 설정 화면(프로젝트 정보 편집, 사용자 관리, 역할 매트릭스 등)을
**2개의 독립 라우트(`/admin/project`, `/admin/system`)**로 통합하여,
프로젝트 수준 설정과 시스템 수준 설정을 명확히 분리한다.

> **핵심 분리 원칙**: 프로젝트 설정은 **프로젝트 범위 내**의 구성(Part, Phase, Member, Sprint 정책 등)을 다루고,
> 시스템 설정은 **전역 범위**의 구성(사용자 CRUD, 시스템 역할, 통합 서비스, 감사 로그, AI 모델 관리 등)을 다룬다.
> 두 화면은 Capability 기반으로 완전히 독립 접근 제어된다.

> **v2.1 추가 철학**: 관리자 콘솔이 "운영 수준"으로 동작하려면 세 가지 축이 완결되어야 한다.
> **(1) Capability 즉시 세분화** — `admin_project` 단일 → 조회/편집 7종 활성, `admin_system` + `admin_models` 분리
> **(2) 낙관적 잠금(Optimistic Lock)** — 다수 관리자 동시 편집 시 충돌 감지 + diff 머지 UI
> **(3) 변경 영향 분석(Impact Preview)** — 삭제/비활성화/역할변경 전 ImpactPreviewDialog 공통 패턴 적용

### 1.2 설계 원칙

| 원칙 | 설명 |
|------|------|
| **2-라우트 분리** | 프로젝트 설정(`/admin/project`)과 시스템 설정(`/admin/system`)은 독립 라우트 |
| **탭 기반 구성** | 각 라우트 내부는 탭으로 세부 영역을 분리 (URL query: `?tab=`) |
| **Capability 게이트** | `admin_project`는 PM/PMO, `admin_system`은 ADMIN만 접근 |
| **변경 감사 추적** | 모든 설정 변경은 audit log에 기록, 변경 전/후 diff 저장 |
| **단계적 저장** | 탭별 독립 저장 (전체 일괄 저장 아님), 변경 사항 감지 시 이탈 경고 |
| **조직도 시각화** | 프로젝트 조직 구조를 트리 다이어그램으로 시각화 |
| **Phase = 트랙 구분** | AI 단계 / SI 단계를 `trackType`으로 구분 (R2dbcPhase.TrackType) |
| **역할-권한 매트릭스** | RoleMatrixEditor로 프로젝트 역할별 Capability를 시각적으로 편집 |
| **Capability 세분화** | `admin_project`를 조회(`_view`)와 편집(`_edit_*`, `_manage_*`)으로 분리하여 Role 체크 제거 |
| **낙관적 잠금** | 모든 PUT 요청에 `version` 필드 포함, 충돌 시 409 + diff 머지 UI |
| **영향 분석 공통 패턴** | 삭제/비활성화/역할변경 전 `ImpactPreviewDialog`로 영향 범위 + 자동 조치 옵션 표시 |
| **확장 필드 저장소** | `project_profile` 정형 테이블로 고객사/M·M/협력사 등 컬럼화, 감사 diff 가능 |
| **감사 로그 경계** | 프로젝트 범위 변경은 프로젝트 로그에만 기록, 시스템 로그는 계정/전역/통합/백업만 |
| **감사 fieldPath 표준** | `AuditChange.fieldPath`를 dot-notation 규칙 기반 경로로 통일 |
| **통합 설정 런타임 안전** | N회 측정 테스트, 설정 버전 롤백, Change Freeze 모드 |
| **백업/복원 안전 절차** | 복원은 비동기 Job + 확인 코드 입력, 복원 전 자동 백업 생성 |
| **AI 모델 관리** | `/admin/system?tab=models` 탭으로 LLM 모델 CRUD + 상태 모니터링 + 핫스왑 |

### 1.3 핵심 질문 → 위젯 매핑

| 사용자 질문 | 화면/탭 | 라우트 |
|-----------|--------|--------|
| "프로젝트 기본 정보 수정하고 싶어" | 프로젝트 설정 > 기본 정보 탭 | `/admin/project?tab=general` |
| "파트 구성을 변경하려면?" | 프로젝트 설정 > Sub-Part 탭 | `/admin/project?tab=parts` |
| "프로젝트 조직도 보여줘" | 프로젝트 설정 > 조직도 탭 | `/admin/project?tab=org-chart` |
| "단계 일정을 조정해야 해" | 프로젝트 설정 > Phase 설정 탭 | `/admin/project?tab=phases` |
| "역할별 권한을 수정하고 싶어" | 프로젝트 설정 > 역할-권한 탭 | `/admin/project?tab=roles` |
| "칸반 WIP 제한을 변경하려면?" | 프로젝트 설정 > 칸반/Sprint 탭 | `/admin/project?tab=workflow` |
| "알림 설정을 바꾸고 싶어" | 프로젝트 설정 > 알림 탭 | `/admin/project?tab=notifications` |
| "사용자를 추가해야 해" | 시스템 설정 > 사용자 관리 탭 | `/admin/system?tab=users` |
| "시스템 역할을 관리하려면?" | 시스템 설정 > 역할 관리 탭 | `/admin/system?tab=roles` |
| "AI 서비스 연동 상태는?" | 시스템 설정 > 통합 설정 탭 | `/admin/system?tab=integrations` |
| "감사 로그를 확인하고 싶어" | 시스템 설정 > 감사 로그 탭 | `/admin/system?tab=audit-log` |
| "시스템 상태가 어떤가?" | 시스템 설정 > 시스템 모니터링 탭 | `/admin/system?tab=health` |
| "LLM 모델 상태 확인해줘" | 시스템 설정 > 모델 관리 탭 | `/admin/system?tab=models` |
| "모델을 교체하고 싶어" | 시스템 설정 > 모델 관리 탭 | `/admin/system?tab=models` |
| "모델 추론 성능은?" | 시스템 설정 > 모델 관리 탭 | `/admin/system?tab=models` |

---

## 2. MenuOntology 노드

### 2.1 타입 확정

| 항목 | 값 | 비고 |
|------|-----|------|
| `nodeId` | `admin-project`, `admin-system` | 2개 독립 노드 |
| `domain` | `"admin"` | 관리 도메인 |
| `nodeRole` | `"action"` | 설정/변경 전용 (행동 질문에 +10 가산) |
| `entities` | `"Project"`, `"Phase"`, `"Part"`, `"User"` | 관련 엔티티 |
| `requiredCaps` | `["admin_project"]`, `["admin_system"]` | 각각 독립 |
| `filterSpec` | `tab` 기반 | 탭 전환으로 하위 영역 접근 |

### 2.2 FilterSpec 정의

```typescript
/** 프로젝트 설정 필터 스키마 */
export interface AdminProjectFilterSpec {
  /** 활성 탭 */
  tab?: "general" | "parts" | "org-chart" | "phases" | "roles" | "workflow" | "notifications";
  /** Part 상세 진입 시 */
  partId?: string;
  /** Phase 상세 진입 시 */
  phaseId?: string;
}

/** 시스템 설정 필터 스키마 */
export interface AdminSystemFilterSpec {
  /** 활성 탭 — v2.1: models 탭 추가 */
  tab?: "users" | "roles" | "org-structure" | "config" | "integrations" | "audit-log" | "health" | "models";
  /** 사용자 상세 진입 시 */
  userId?: string;
  /** 모델 상세 진입 시 */
  modelId?: string;
  /** 감사 로그 검색어 */
  q?: string;
  /** 감사 로그 날짜 범위 */
  dateFrom?: string;
  dateTo?: string;
}
```

### 2.3 Admin-Project 노드 (확정본)

```typescript
const adminProjectNode: MenuOntologyNodeV2 = {
  nodeId: "admin-project",
  label: "프로젝트 설정",
  route: "/admin/project",
  icon: "SettingsRounded",
  domain: "admin",
  nodeRole: "action",

  // v2.1: admin_project_view for entry, granular caps for edits
  requiredCaps: ["admin_project_view"],

  intents: [
    // Ask
    "ask_project_settings",
    "ask_part_config",
    "ask_org_chart",
    "ask_phase_config",
    "ask_role_matrix",
    "ask_workflow_config",
    "ask_notification_config",
    // Do — each requires a specific granular capability
    "do_update_project_info",     // admin_project_edit_general
    "do_add_part",                // admin_project_manage_parts
    "do_update_part",             // admin_project_manage_parts
    "do_add_phase",               // admin_project_manage_phases
    "do_update_phase",            // admin_project_manage_phases
    "do_update_role_matrix",      // admin_project_manage_role_matrix
    "do_update_wip_limit",        // admin_project_manage_workflow
    "do_update_sprint_config",    // admin_project_manage_workflow
    "do_update_notification",     // admin_project_manage_notifications
    "do_add_member",              // admin_project_manage_parts
    "do_remove_member",           // admin_project_manage_parts
  ],
  canonicalQuestions: [
    "프로젝트 기본 정보 수정하고 싶어",
    "파트 구성을 변경하려면?",
    "프로젝트 조직도 보여줘",
    "단계 일정을 조정해야 해",
    "역할별 권한 매트릭스 보여줘",
    "칸반 WIP 제한을 변경하려면?",
    "스프린트 주기를 바꾸고 싶어",
    "알림 설정을 수정하려면?",
    "파트에 팀원을 추가하고 싶어",
    "PMO 설정 항목 보여줘",
  ],
  entities: ["Project", "Phase", "Part", "User"],
  keywords: [
    "프로젝트 설정", "파트 설정", "조직도", "단계 설정", "역할 권한",
    "WIP", "스프린트 설정", "알림 설정", "프로젝트 관리", "설정",
    "project settings", "admin", "configuration", "part", "phase",
    "role matrix", "WIP limit", "sprint config", "notification",
    "PMO", "사업관리", "품질관리", "테스트관리", "정보보호관리", "성능관리",
  ],
  metrics: [
    "total_parts",
    "total_members",
    "total_phases",
    "active_phases",
    "wip_limit",
    "sprint_duration",
    "sp_capacity",
  ],

  filterSpec: {
    keys: ["tab", "partId", "phaseId"],
    defaults: { tab: "general" },
  },

  defaultPreset: "PM_WORK",
  presetPolicies: [
    {
      preset: "PM_WORK",
      ui: {
        density: "detailed",
        defaultRightPanel: "open",
        highlight: {
          metricKeys: ["total_parts", "total_members", "total_phases"],
          widgetKeys: ["PROJECT_INFO_FORM", "PART_LIST", "PHASE_TIMELINE_CONFIG"],
        },
      },
      suggestedActions: [
        {
          key: "add_part",
          label: "파트 추가",
          requiredCaps: ["admin_project_manage_parts"],   // v2.1 granular
        },
        {
          key: "add_phase",
          label: "단계 추가",
          requiredCaps: ["admin_project_manage_phases"],   // v2.1 granular
        },
        {
          key: "edit_roles",
          label: "역할-권한 편집",
          requiredCaps: ["admin_project_manage_role_matrix"], // v2.1 granular
          route: "/admin/project?tab=roles",
        },
        {
          key: "edit_workflow",
          label: "칸반/Sprint 설정",
          requiredCaps: ["admin_project_manage_workflow"],  // v2.1 granular
          route: "/admin/project?tab=workflow",
        },
      ],
    },
    {
      preset: "PMO_CONTROL",
      ui: {
        density: "standard",
        defaultRightPanel: "open",
        highlight: {
          metricKeys: ["total_parts", "total_members"],
          widgetKeys: ["PROJECT_INFO_FORM", "ORG_CHART"],
        },
        // PMO can view but limited edit on PMO-specific fields only
      },
      suggestedActions: [
        {
          key: "view_org_chart",
          label: "조직도 확인",
          requiredCaps: ["admin_project_view"],  // v2.1 granular
          route: "/admin/project?tab=org-chart",
        },
        {
          key: "edit_pmo_fields",
          label: "PMO 담당자 편집",
          requiredCaps: ["admin_project_edit_general"],  // v2.1
          route: "/admin/project?tab=general",
        },
      ],
    },
  ],

  deepLinks: [
    {
      pattern: "/admin/project?tab=:tab",
      description: "설정 탭 직접 진입",
      requiredParams: ["tab"],
    },
    {
      pattern: "/admin/project?tab=parts&partId=:partId",
      description: "특정 파트 상세",
      requiredParams: ["partId"],
    },
    {
      pattern: "/admin/project?tab=phases&phaseId=:phaseId",
      description: "특정 단계 상세",
      requiredParams: ["phaseId"],
    },
  ],

  virtualNodes: [
    {
      virtualId: "admin-project.parts",
      label: "파트 설정",
      routeTemplate: "/admin/project?tab=parts",
      requiredParams: [],
      intents: ["ask_part_config", "do_add_part", "do_update_part"],
      description: "Sub-Part 구성 및 팀원 관리 직접 진입",
    },
    {
      virtualId: "admin-project.phases",
      label: "단계(Phase) 설정",
      routeTemplate: "/admin/project?tab=phases",
      requiredParams: [],
      intents: ["ask_phase_config", "do_add_phase", "do_update_phase"],
      description: "프로젝트 Phase 일정/트랙 구성 직접 진입",
    },
    {
      virtualId: "admin-project.roles",
      label: "역할-권한 매트릭스",
      routeTemplate: "/admin/project?tab=roles",
      requiredParams: [],
      intents: ["ask_role_matrix", "do_update_role_matrix"],
      description: "프로젝트 역할별 Capability 매핑 편집 직접 진입",
    },
    {
      virtualId: "admin-project.org-chart",
      label: "프로젝트 조직도",
      routeTemplate: "/admin/project?tab=org-chart",
      requiredParams: [],
      intents: ["ask_org_chart"],
      description: "프로젝트 조직 구조 트리 시각화 직접 진입",
    },
  ],

  scope: {
    keys: ["project"],
    params: ["projectId"],
  },

  priority: 8,
};
```

### 2.4 Admin-System 노드 (확정본)

```typescript
const adminSystemNode: MenuOntologyNodeV2 = {
  nodeId: "admin-system",
  label: "시스템 설정",
  route: "/admin/system",
  icon: "AdminPanelSettingsRounded",
  domain: "admin",
  nodeRole: "action",

  requiredCaps: ["admin_system"],

  intents: [
    // Ask
    "ask_user_list",
    "ask_system_roles",
    "ask_org_structure",
    "ask_system_config",
    "ask_integration_status",
    "ask_audit_log",
    "ask_system_health",
    "ask_model_status",           // v2.1
    "ask_model_list",             // v2.1
    // Do
    "do_create_user",
    "do_update_user",
    "do_deactivate_user",
    "do_update_system_role",
    "do_update_system_config",
    "do_update_integration",
    "do_backup_system",
    "do_restore_system",
    "do_register_model",          // v2.1
    "do_activate_model",          // v2.1
    "do_deactivate_model",        // v2.1
  ],
  canonicalQuestions: [
    "사용자를 추가해야 해",
    "사용자 목록 보여줘",
    "시스템 역할을 관리하려면?",
    "조직 구조 설정은?",
    "AI 서비스 연동 상태 알려줘",
    "Neo4j 연결 상태는?",
    "Redis 캐시 상태는?",
    "감사 로그 확인하고 싶어",
    "시스템 상태가 어떤가?",
    "백업 설정을 하고 싶어",
    "사용자 비활성화하려면?",
    "LLM 모델 상태 확인해줘",     // v2.1
    "모델을 교체하고 싶어",        // v2.1
  ],
  entities: ["User", "Model"],    // v2.1: Model 추가
  keywords: [
    "시스템 설정", "사용자 관리", "역할 관리", "조직 구조",
    "통합 설정", "연동", "감사 로그", "시스템 모니터링",
    "system settings", "user management", "role management",
    "integration", "audit log", "health", "backup", "restore",
    "AI 서비스", "Neo4j", "Redis", "ADMIN",
    "LLM", "모델 관리", "model management", "Gemma", "GGUF",  // v2.1
    "추론", "inference", "핫스왑", "hot-swap",                  // v2.1
  ],
  metrics: [
    "total_users",
    "active_users",
    "total_projects",
    "system_uptime",
    "ai_service_status",
    "neo4j_status",
    "redis_status",
    "db_status",
    "audit_log_count",
    "active_model_count",         // v2.1
    "model_avg_latency",          // v2.1
  ],

  filterSpec: {
    keys: ["tab", "userId", "modelId", "q", "dateFrom", "dateTo"],  // v2.1: modelId
    defaults: { tab: "users" },
  },

  // v2.1: PMO_CONTROL → ADMIN_OPS (system-only preset)
  defaultPreset: "ADMIN_OPS",
  presetPolicies: [
    {
      preset: "ADMIN_OPS",
      ui: {
        density: "standard",
        defaultRightPanel: "open",
        highlight: {
          metricKeys: ["total_users", "active_users", "system_uptime"],
          widgetKeys: ["USER_TABLE", "SYSTEM_HEALTH_CARDS"],
        },
      },
      suggestedActions: [
        {
          key: "create_user",
          label: "사용자 추가",
          requiredCaps: ["admin_system"],
        },
        {
          key: "view_audit_log",
          label: "감사 로그",
          requiredCaps: ["admin_system"],
          route: "/admin/system?tab=audit-log",
        },
        {
          key: "view_health",
          label: "시스템 모니터링",
          requiredCaps: ["admin_system"],
          route: "/admin/system?tab=health",
        },
        {
          key: "manage_models",
          label: "모델 관리",
          requiredCaps: ["admin_models"],  // v2.1
          route: "/admin/system?tab=models",
        },
      ],
    },
  ],

  deepLinks: [
    {
      pattern: "/admin/system?tab=:tab",
      description: "시스템 설정 탭 직접 진입",
      requiredParams: ["tab"],
    },
    {
      pattern: "/admin/system?tab=users&userId=:userId",
      description: "특정 사용자 상세",
      requiredParams: ["userId"],
    },
    {
      pattern: "/admin/system?tab=audit-log&q=:q",
      description: "감사 로그 검색",
      requiredParams: ["q"],
    },
    {
      pattern: "/admin/system?tab=models&modelId=:modelId",
      description: "특정 모델 상세",
      requiredParams: ["modelId"],
    },
  ],

  virtualNodes: [
    {
      virtualId: "admin-system.users",
      label: "사용자 관리",
      routeTemplate: "/admin/system?tab=users",
      requiredParams: [],
      intents: ["ask_user_list", "do_create_user", "do_update_user", "do_deactivate_user"],
      description: "사용자 CRUD 관리 직접 진입",
    },
    {
      virtualId: "admin-system.audit-log",
      label: "감사 로그",
      routeTemplate: "/admin/system?tab=audit-log",
      requiredParams: [],
      intents: ["ask_audit_log"],
      description: "시스템 감사 로그 뷰어 직접 진입",
    },
    {
      virtualId: "admin-system.health",
      label: "시스템 모니터링",
      routeTemplate: "/admin/system?tab=health",
      requiredParams: [],
      intents: ["ask_system_health"],
      description: "시스템 헬스 체크 및 서비스 상태 모니터링 직접 진입",
    },
    {
      virtualId: "admin-system.integrations",
      label: "통합 설정",
      routeTemplate: "/admin/system?tab=integrations",
      requiredParams: [],
      intents: ["ask_integration_status", "do_update_integration"],
      description: "AI/Neo4j/Redis 연동 설정 및 상태 확인 직접 진입",
    },
    {
      virtualId: "admin-system.models",
      label: "모델 관리",
      routeTemplate: "/admin/system?tab=models",
      requiredParams: [],
      intents: ["ask_model_status", "ask_model_list", "do_register_model", "do_activate_model", "do_deactivate_model"],
      description: "LLM 모델 등록/활성화/비활성화/성능 모니터링 직접 진입",
    },
  ],

  scope: {
    keys: [],       // system-wide, no project scope
    params: [],
  },

  priority: 9,
};
```

---

## 3. 화면 구조

### 3.1 panelMode 정의

| 화면 | panelMode | Main | Right Panel |
|------|-----------|------|------------|
| 프로젝트 설정 | `tabs + detail` | 탭별 설정 폼/테이블 (70%) | 컨텍스트 상세 (30%) |
| 시스템 설정 | `tabs + detail` | 탭별 관리 테이블/폼 (70%) | 사용자 상세/로그 상세 (30%) |

### 3.2 프로젝트 설정 와이어프레임 (`/admin/project`)

```
+----------------------------------------------------------------------+
|  Page Header                                                          |
|  프로젝트 설정  [ AI 보험금지급심사 구축 ]  [ 저장 ]  [ 취소 ]          |
+----------------------------------------------------------------------+
|  Tab Bar                                                              |
|  [ 기본정보 ] [ Sub-Part ] [ 조직도 ] [ Phase ] [ 역할-권한 ]          |
|  [ 칸반/Sprint ] [ 알림 ]                                             |
+----------------------------------------------------------------------+
|                                                                      |
|  +------------------------------------------+  +------------------+ |
|  |  Main Content (Tab-dependent)            |  |  Right Panel     | |
|  |                                          |  |                  | |
|  |  [기본정보 Tab 선택 시]                    |  |  변경 이력       | |
|  |                                          |  |                  | |
|  |  프로젝트명: [ AI 보험금지급심사 구축  ]   |  |  2026-02-07      | |
|  |  고객사:     [ XX보험            ]        |  |  PM 변경         | |
|  |  시작일:     [ 2026-01-06 ]               |  |  김철수 -> 박영희| |
|  |  종료일:     [ 2026-12-31 ]               |  |                  | |
|  |  규모(금액): [ 50억원          ]           |  |  2026-02-05      | |
|  |  규모(M/M):  [ 120 M/M        ]           |  |  기간 변경       | |
|  |  협력사:     [ ABC시스템, DEF테크  ]       |  |  종료일 연장     | |
|  |  수행PM:     [ 박영희 ▼         ]          |  |                  | |
|  |  은장수:     [ 3명              ]          |  |                  | |
|  |                                          |  |                  | |
|  |  --- PMO 설정 ---                         |  |                  | |
|  |  사업관리:     [ 김사업 ▼ ]                |  |                  | |
|  |  품질관리:     [ 이품질 ▼ ]                |  |                  | |
|  |  테스트관리:   [ 박테스트 ▼ ]              |  |                  | |
|  |  정보보호관리: [ 최보안 ▼ ]                |  |                  | |
|  |  성능관리:     [ 정성능 ▼ ]                |  |                  | |
|  |                                          |  |                  | |
|  +------------------------------------------+  +------------------+ |
|                                                                      |
+----------------------------------------------------------------------+
```

### 3.3 프로젝트 설정 - Sub-Part 탭 와이어프레임

```
+----------------------------------------------------------------------+
|  Tab: [ Sub-Part ] (active)                                           |
+----------------------------------------------------------------------+
|                                                                      |
|  [ + 파트 추가 ]                                                      |
|                                                                      |
|  +------------------------------------------+  +------------------+ |
|  |  Part List                               |  |  Part Detail     | |
|  |                                          |  |                  | |
|  |  +--------------------------------------+|  |  Part: AI 개발팀 | |
|  |  | Part명      | M/M  | 인원 | 파트리더 ||  |                  | |
|  |  |-------------|------|------|----------||  |  투입공수: 40 M/M| |
|  |  | AI 개발팀   | 40   |  8   | 김개발   ||  |  인원: 8명       | |
|  |  | SI 개발팀   | 35   |  7   | 이시스   ||  |  파트리더: 김개발| |
|  |  | 인프라팀    | 20   |  4   | 박인프   ||  |                  | |
|  |  | QA팀        | 15   |  3   | 최품질   ||  |  --- 팀원 ---    | |
|  |  | PMO         | 10   |  2   | 정피엠   ||  |  성명  | 직책    | |
|  |  +--------------------------------------+|  |  ------|------   | |
|  |                                          |  |  김개발 | PL     | |
|  |  * 행 클릭 -> Right Panel 갱신           |  |  박백엔 | 선임   | |
|  |                                          |  |  이프론 | 선임   | |
|  |                                          |  |  최주니 | 사원   | |
|  |                                          |  |  ... (4명 더)    | |
|  |                                          |  |                  | |
|  |                                          |  |  [ 편집 ] [삭제] | |
|  +------------------------------------------+  +------------------+ |
|                                                                      |
+----------------------------------------------------------------------+
```

### 3.4 프로젝트 설정 - 조직도 탭 와이어프레임

```
+----------------------------------------------------------------------+
|  Tab: [ 조직도 ] (active)                                             |
+----------------------------------------------------------------------+
|                                                                      |
|  +----------------------------------------------------------------+ |
|  |                      프로젝트 조직도                              | |
|  |                                                                  | |
|  |                      +------------+                              | |
|  |                      |  수행 PM   |                              | |
|  |                      |  박영희    |                              | |
|  |                      +-----+------+                              | |
|  |                            |                                     | |
|  |         +------+------+---+---+------+------+                    | |
|  |         |      |      |       |      |      |                    | |
|  |      +--+--+ +-+--+ +-+--+ +-+--+ +-+--+ +-+--+                | |
|  |      |AI   | |SI  | |인프| |QA  | |PMO | |사업|                | |
|  |      |개발 | |개발| |라  | |    | |    | |관리|                | |
|  |      |김개발| |이시| |박인| |최품| |정피| |김사|                | |
|  |      +--+--+ +-+--+ +-+--+ +-+--+ +----+ +----+                | |
|  |         |      |      |       |                                  | |
|  |       8명    7명    4명     3명                                  | |
|  |                                                                  | |
|  +----------------------------------------------------------------+ |
|                                                                      |
|  [ PNG Export ]  [ PDF Export ]                                       |
|                                                                      |
+----------------------------------------------------------------------+
```

### 3.5 프로젝트 설정 - Phase 설정 탭 와이어프레임

```
+----------------------------------------------------------------------+
|  Tab: [ Phase ] (active)                                              |
+----------------------------------------------------------------------+
|                                                                      |
|  [ + 단계 추가 ]  필터: [ AI ▼ ] [ SI ▼ ] [ 공통 ▼ ]                 |
|                                                                      |
|  +------------------------------------------+  +------------------+ |
|  |  Phase Timeline (Gantt-like)             |  |  Phase Detail    | |
|  |                                          |  |                  | |
|  |        Jan  Feb  Mar  Apr  May  Jun ...  |  |  Phase: 설계     | |
|  |  분석   ████                              |  |                  | |
|  |  설계        ████████                     |  |  시작일: 02-01   | |
|  |  개발              ████████████████       |  |  종료일: 03-31   | |
|  |  테스트                      ████████     |  |  트랙: COMMON    | |
|  |  이행                              ████   |  |  상태: NOT_START | |
|  |  안정화                              ██   |  |                  | |
|  |                                          |  |  관련 파트:      | |
|  |  --- AI 트랙 ---                         |  |  - AI 개발팀     | |
|  |  AI 모델학습  ████████                    |  |  - SI 개발팀     | |
|  |  AI 검증            ████                  |  |                  | |
|  |                                          |  |  관련 Task: 42건 | |
|  |  * 바 클릭 -> Right Panel 갱신           |  |                  | |
|  |                                          |  |  [ 편집 ] [삭제] | |
|  +------------------------------------------+  +------------------+ |
|                                                                      |
+----------------------------------------------------------------------+
```

### 3.6 프로젝트 설정 - 역할-권한 매트릭스 탭 와이어프레임

```
+----------------------------------------------------------------------+
|  Tab: [ 역할-권한 ] (active)                                          |
+----------------------------------------------------------------------+
|                                                                      |
|  RoleMatrixEditor                                                    |
|                                                                      |
|  +----------------------------------------------------------------+ |
|  |            | SPONSOR | PMO | PM | DEV | QA | BA | MEMBER      | |
|  |------------|---------|-----|----|-----|----|----|-------------- | |
|  | view_back  |   [v]   | [v] |[v] | [v] |[v] |[v] |  [v]       | |
|  | manage_bk  |   [ ]   | [ ] |[v] | [ ] |[ ] |[ ] |  [ ]       | |
|  | view_kanbn |   [v]   | [v] |[v] | [v] |[v] |[ ] |  [ ]       | |
|  | manage_kbn |   [ ]   | [ ] |[v] | [v] |[ ] |[ ] |  [ ]       | |
|  | view_issue |   [v]   | [v] |[v] | [v] |[v] |[v] |  [v]       | |
|  | manage_iss |   [ ]   | [v] |[v] | [v] |[ ] |[ ] |  [ ]       | |
|  | view_test  |   [v]   | [v] |[v] | [v] |[v] |[ ] |  [ ]       | |
|  | manage_tst |   [ ]   | [ ] |[v] | [ ] |[v] |[ ] |  [ ]       | |
|  | view_deliv |   [v]   | [v] |[v] | [v] |[v] |[v] |  [v]       | |
|  | approve_dv |   [v]   | [v] |[v] | [ ] |[ ] |[ ] |  [ ]       | |
|  | admin_proj |   [ ]   | [v] |[v] | [ ] |[ ] |[ ] |  [ ]       | |
|  | export_rpt |   [v]   | [v] |[v] | [ ] |[ ] |[ ] |  [ ]       | |
|  | ...        |   ...   | ... |... | ... |... |... |  ...        | |
|  +----------------------------------------------------------------+ |
|  |  [v] = 허용    [ ] = 차단    [v] 회색 = 상속(읽기전용)          | |
|  +----------------------------------------------------------------+ |
|                                                                      |
|  [ 기본값 복원 ]  [ 저장 ]                                            |
|                                                                      |
+----------------------------------------------------------------------+
```

### 3.7 시스템 설정 와이어프레임 (`/admin/system`)

```
+----------------------------------------------------------------------+
|  Page Header                                                          |
|  시스템 설정  [ ADMIN: 관리자 ]                                       |
+----------------------------------------------------------------------+
|  Tab Bar                                                              |
|  [ 사용자 관리 ] [ 역할 관리 ] [ 조직 구조 ] [ 시스템 구성 ]           |
|  [ 통합 설정 ] [ 감사 로그 ] [ 시스템 모니터링 ] [ 모델 관리 ]        |
+----------------------------------------------------------------------+
|                                                                      |
|  [사용자 관리 Tab 선택 시]                                             |
|                                                                      |
|  [ + 사용자 추가 ]  검색: [           ]  역할: [ 전체 ▼ ]             |
|                                                                      |
|  +------------------------------------------+  +------------------+ |
|  |  UserManagementTable                     |  |  User Detail     | |
|  |                                          |  |                  | |
|  |  이름    | 이메일          | 역할  | 상태 |  |  이름: 김개발    | |
|  |  --------|----------------|-------|------||  |  이메일:         | |
|  |  김개발  | dev@co.kr      | DEV   | 활성 ||  |   dev@co.kr     | |
|  |  이시스  | si@co.kr       | DEV   | 활성 ||  |  역할: DEV      | |
|  |  박영희  | pm@co.kr       | PM    | 활성 ||  |  부서: 개발1팀  | |
|  |  정피엠  | pmo@co.kr      | PMO   | 활성 ||  |  상태: 활성     | |
|  |  최관리  | admin@co.kr    | ADMIN | 활성 ||  |  마지막 로그인: | |
|  |  외부감  | audit@ext.kr   | AUDIT | 활성 ||  |   2026-02-08    | |
|  |  퇴사자  | old@co.kr      | DEV   | 비활 ||  |                  | |
|  |                                          |  |  참여 프로젝트:  | |
|  |  * 행 클릭 -> Right Panel 갱신           |  |  - AI 보험심사   | |
|  |                                          |  |  - 차세대 Core   | |
|  |                                          |  |                  | |
|  |                                          |  |  [편집][비활성화]| |
|  +------------------------------------------+  +------------------+ |
|                                                                      |
+----------------------------------------------------------------------+
```

### 3.8 시스템 설정 - 통합 설정 탭 와이어프레임

```
+----------------------------------------------------------------------+
|  Tab: [ 통합 설정 ] (active)                                          |
+----------------------------------------------------------------------+
|                                                                      |
|  +----------------------------------------------------------------+ |
|  |  Service Health Overview                                        | |
|  |                                                                  | |
|  |  +----------+  +----------+  +----------+  +----------+        | |
|  |  | Postgres |  |  Redis   |  |  Neo4j   |  | AI (LLM) |        | |
|  |  |  :5433   |  |  :6379   |  |  :7687   |  |  :8000   |        | |
|  |  |  [OK]    |  |  [OK]    |  | [WARN]   |  |  [OK]    |        | |
|  |  | latency  |  | hit rate |  | nodes    |  | model    |        | |
|  |  |  12ms    |  |  94.2%   |  |  1/3     |  | Gemma-3  |        | |
|  |  +----------+  +----------+  +----------+  +----------+        | |
|  |                                                                  | |
|  +----------------------------------------------------------------+ |
|  |                                                                  | |
|  |  Service Configuration                                          | |
|  |                                                                  | |
|  |  AI Service                                                     | |
|  |    URL:        [ http://llm-service:8000     ]                  | |
|  |    Model Path: [ ./models/gemma-3-12b-Q5_K_M ]                 | |
|  |    Status:     [OK] Connected                                   | |
|  |    [ 연결 테스트 ]                                               | |
|  |                                                                  | |
|  |  Neo4j                                                          | |
|  |    URI:        [ bolt://neo4j:7687           ]                  | |
|  |    Status:     [WARN] 1 of 3 nodes available                   | |
|  |    [ 연결 테스트 ]                                               | |
|  |                                                                  | |
|  |  Redis                                                          | |
|  |    Host:       [ redis:6379                  ]                  | |
|  |    Status:     [OK] Connected                                   | |
|  |    Hit Rate:   94.2%                                            | |
|  |    [ 연결 테스트 ]  [ 캐시 초기화 ]                               | |
|  |                                                                  | |
|  +----------------------------------------------------------------+ |
|                                                                      |
+----------------------------------------------------------------------+
```

### 3.9 시스템 설정 - 감사 로그 탭 와이어프레임

```
+----------------------------------------------------------------------+
|  Tab: [ 감사 로그 ] (active)                                          |
+----------------------------------------------------------------------+
|                                                                      |
|  검색: [              ]  기간: [ 2026-02-01 ] ~ [ 2026-02-08 ]       |
|  유형: [ 전체 ▼ ]  사용자: [ 전체 ▼ ]  [ 검색 ]  [ Export CSV ]      |
|                                                                      |
|  +------------------------------------------+  +------------------+ |
|  |  Audit Log Table                         |  |  Log Detail      | |
|  |                                          |  |                  | |
|  |  시간       | 사용자 | 유형  | 대상     |  |  시간:           | |
|  |  -----------|--------|-------|----------||  |  2026-02-08      | |
|  |  02-08 14:30| 박영희 | UPDATE| 프로젝트 ||  |  14:30:25        | |
|  |  02-08 13:15| 김개발 | CREATE| 사용자   ||  |                  | |
|  |  02-08 11:00| 최관리 | UPDATE| 역할설정 ||  |  사용자: 박영희  | |
|  |  02-07 16:45| 정피엠 | DELETE| 파트원   ||  |  유형: UPDATE    | |
|  |  02-07 15:20| 박영희 | UPDATE| Phase    ||  |  대상: 프로젝트  | |
|  |  02-07 10:30| 최관리 | CREATE| 사용자   ||  |                  | |
|  |  ...                                     |  |  --- 변경 Diff --| |
|  |                                          |  |  - 종료일:       | |
|  |  페이지: [ < 1 2 3 ... 10 > ]            |  |    12-30 -> 12-31| |
|  |                                          |  |  - 예산:         | |
|  |  * 행 클릭 -> Right Panel 갱신           |  |    48억 -> 50억  | |
|  +------------------------------------------+  +------------------+ |
|                                                                      |
+----------------------------------------------------------------------+
```

### 3.10 시스템 설정 - 시스템 모니터링 탭 와이어프레임

```
+----------------------------------------------------------------------+
|  Tab: [ 시스템 모니터링 ] (active)                                    |
+----------------------------------------------------------------------+
|                                                                      |
|  +----------+  +----------+  +----------+  +----------+              |
|  | Uptime   |  | CPU      |  | Memory   |  | Disk     |              |
|  | 32d 14h  |  | 45%      |  | 68%      |  | 52%      |              |
|  |  [OK]    |  |  [OK]    |  | [WARN]   |  |  [OK]    |              |
|  +----------+  +----------+  +----------+  +----------+              |
|                                                                      |
|  +----------------------------------------------------------------+ |
|  |  Service Status Matrix                                          | |
|  |                                                                  | |
|  |  Service       | Status | Latency | Last Check | Actions        | |
|  |  --------------|--------|---------|------------|---------------- | |
|  |  Backend (BE)  | [OK]   | 8ms     | 14:30      | [ Restart ]    | |
|  |  Frontend (FE) | [OK]   | -       | 14:30      | [ Rebuild ]    | |
|  |  PostgreSQL    | [OK]   | 12ms    | 14:30      | [ Health ]     | |
|  |  Redis         | [OK]   | 2ms     | 14:30      | [ Flush ]      | |
|  |  Neo4j         | [WARN] | 45ms    | 14:30      | [ Details ]    | |
|  |  LLM Service   | [OK]   | 350ms   | 14:30      | [ Model Info ] | |
|  |                                                                  | |
|  +----------------------------------------------------------------+ |
|                                                                      |
|  +----------------------------------------------------------------+ |
|  |  Backup Status                                                  | |
|  |                                                                  | |
|  |  Last Backup:  2026-02-08 03:00 (자동)                          | |
|  |  Backup Size:  2.4 GB                                           | |
|  |  Schedule:     매일 03:00 (자동)                                | |
|  |                                                                  | |
|  |  [ 수동 백업 ]  [ 복원 ]  [ 백업 설정 ]                          | |
|  +----------------------------------------------------------------+ |
|                                                                      |
+----------------------------------------------------------------------+
```

### 3.11 시스템 설정 - 모델 관리 탭 와이어프레임 (v2.1)

```
+----------------------------------------------------------------------+
|  Tab: [ 모델 관리 ] (active)                                          |
+----------------------------------------------------------------------+
|                                                                      |
|  [ + 모델 등록 ]  필터: [ 전체 ▼ ] [ 활성만 ▼ ]                      |
|                                                                      |
|  +------------------------------------------+  +------------------+ |
|  |  Model Registry Table                    |  |  Model Detail    | |
|  |                                          |  |                  | |
|  |  모델명    | 타입 | 상태  | 지연  | GPU  |  |  Gemma-3-12B     | |
|  |  ----------|------|-------|-------|------||  |  Q5_K_M          | |
|  |  Gemma-3   | L2   | [ACT] | 350ms| 8.2G ||  |                  | |
|  |  LFM2-2.6B | L1   | [ACT] | 45ms | 2.1G ||  |  타입: L2 (품질) | |
|  |  Gemma-old | L2   | [OFF] | -    | -    ||  |  상태: ACTIVE    | |
|  |                                          |  |  파일: gemma-3.. | |
|  |  * 행 클릭 -> Right Panel 갱신           |  |  크기: 8.2 GB    | |
|  |                                          |  |  로드 시간: 12s  | |
|  +------------------------------------------+  |                  | |
|                                                 |  --- 성능 ---    | |
|  +------------------------------------------+  |  평균 지연: 350ms| |
|  |  Active Model Performance (30min window) |  |  P95 지연: 820ms | |
|  |                                          |  |  처리량: 42 r/m  | |
|  |  L1 (LFM2-2.6B):                        |  |  오류율: 0.2%    | |
|  |    Avg: 45ms  P95: 120ms  RPS: 180       |  |                  | |
|  |  L2 (Gemma-3-12B):                       |  |  [ 비활성화 ]    | |
|  |    Avg: 350ms P95: 820ms  RPS: 42        |  |  [ 핫스왑 ]      | |
|  |                                          |  |  [ 삭제 ]        | |
|  +------------------------------------------+  +------------------+ |
|                                                                      |
+----------------------------------------------------------------------+
```

---

## 4. Preset별 차이

### 4.1 프로젝트 설정 (`/admin/project`)

> 프로젝트 설정은 PM_WORK, PMO_CONTROL 2개 Preset만 접근 가능하다.
> 다른 Preset(DEV, EXEC, CUSTOMER, AUDIT)은 메뉴 자체가 숨겨진다.

| 항목 | PM_WORK | PMO_CONTROL |
|------|---------|-------------|
| **접근** | Full access | Limited access |
| **기본 정보** | 전체 편집 | 조회 전용 (PMO 필드만 편집) |
| **Sub-Part** | 추가/편집/삭제 | 조회 전용 |
| **조직도** | 편집 + Export | 조회 + Export |
| **Phase** | 추가/편집/삭제 | 조회 전용 |
| **역할-권한** | 전체 편집 | 조회 전용 |
| **칸반/Sprint** | 전체 편집 | 조회 전용 |
| **알림** | 전체 편집 | 자기 알림만 편집 |
| **UI 밀도** | `detailed` | `standard` |
| **Right Panel** | `open` (변경 이력) | `open` (변경 이력) |

### 4.2 시스템 설정 (`/admin/system`)

> 시스템 설정은 ADMIN 역할(시스템 운영자)만 접근 가능하다.
> v2.1: Preset 명칭을 `ADMIN_OPS`로 변경하여 역할 의미를 명확히 한다.
> 권한 분기는 Capability(`admin_system`, `admin_models`)로만 통제하고, Preset은 UI 밀도용으로만 사용한다.

| 항목 | ADMIN_OPS (ADMIN only) |
|------|------------------------|
| **사용자 관리** | Full CRUD |
| **역할 관리** | Full 편집 |
| **조직 구조** | Full 편집 |
| **시스템 구성** | Full 편집 |
| **통합 설정** | 조회 + N회 측정 테스트 + 캐시 초기화 + 롤백 + Change Freeze |
| **감사 로그** | 조회 + Export |
| **시스템 모니터링** | 조회 + 수동 백업/복원 (복원은 확인 코드 필수) |
| **모델 관리** | 등록/활성화/비활성화/핫스왑/삭제 + 성능 모니터링 |

---

## 5. 프로젝트 설정 상세

### 5.1 기본 정보 탭 (`?tab=general`)

#### 5.1.1 필드 목록

| 필드 | 타입 | 필수 | 편집 권한 | DB 매핑 |
|------|------|------|---------|---------|
| 프로젝트명 | `text` | Y | PM | `project.projects.name` |
| 설명 | `textarea` | N | PM | `project.projects.description` |
| 고객사 | `text` | Y | PM | 확장 필드 |
| 시작일 | `date` | Y | PM | `project.projects.start_date` |
| 종료일 | `date` | Y | PM | `project.projects.end_date` |
| 상태 | `select` | Y | PM | `project.projects.status` |
| 규모(금액) | `number` | N | PM | `project.projects.budget` |
| 규모(M/M) | `number` | N | PM | 확장 필드 |
| 협력사 | `tag-input` | N | PM | 확장 필드 |
| 수행PM | `user-select` | Y | PM | `project.project_members` (role=PM) |
| 은장수 | `number` | N | PM | 확장 필드 |
| AI 가중치 | `slider` | N | PM | `project.projects.ai_weight` |
| SI 가중치 | `slider` | N | PM | `project.projects.si_weight` |

#### 5.1.1a 확장 필드 저장소 설계 (v2.1)

> v2.0에서 "확장 필드"로만 표기되었던 고객사/규모(M/M)/협력사/은장수 등의 DB 매핑을 확정한다.
> 정형 리포팅(예산 집계, M/M 통계, 협력사별 분석)이 핵심이므로 **정형 테이블(project_profile)** 방식을 채택한다.

```sql
-- project 스키마 확장
CREATE TABLE project.project_profiles (
  project_id    UUID PRIMARY KEY REFERENCES project.projects(id),
  customer_name VARCHAR(200),                -- 고객사
  man_month     NUMERIC(8,1),                -- 규모(M/M)
  head_count    INTEGER,                      -- 은장수
  cooperators   TEXT[],                       -- 협력사 (배열)
  ai_weight     NUMERIC(3,1) DEFAULT 50,      -- AI 가중치 (0~100)
  si_weight     NUMERIC(3,1) DEFAULT 50,      -- SI 가중치 (0~100)
  version       BIGINT NOT NULL DEFAULT 1,    -- optimistic lock
  created_at    TIMESTAMPTZ DEFAULT now(),
  updated_at    TIMESTAMPTZ DEFAULT now()
);

-- 감사 diff 지원: 각 컬럼이 독립 fieldPath로 추적됨
-- 예: fieldPath = "project_profile.customer_name"
```

> **기존 `projects` 테이블의 `budget` 컬럼**은 그대로 유지 (규모/금액).
> `ai_weight`, `si_weight`도 `projects` 테이블에 이미 존재하면 중복 제거 — `project_profiles`로 이전.

| 확장 필드 | DB 컬럼 | 타입 | 감사 fieldPath |
|----------|---------|------|---------------|
| 고객사 | `project_profiles.customer_name` | `VARCHAR(200)` | `project_profile.customer_name` |
| 규모(M/M) | `project_profiles.man_month` | `NUMERIC(8,1)` | `project_profile.man_month` |
| 협력사 | `project_profiles.cooperators` | `TEXT[]` | `project_profile.cooperators` |
| 은장수 | `project_profiles.head_count` | `INTEGER` | `project_profile.head_count` |

#### 5.1.2 PMO 설정 필드

| 필드 | 타입 | 편집 권한 | 설명 |
|------|------|---------|------|
| 사업관리 | `user-select` | PM, PMO | 사업관리 담당자 |
| 품질관리 | `user-select` | PM, PMO | 품질관리 담당자 |
| 테스트관리 | `user-select` | PM, PMO | 테스트관리 담당자 |
| 정보보호관리 | `user-select` | PM, PMO | 정보보호관리 담당자 |
| 성능관리 | `user-select` | PM, PMO | 성능관리 담당자 |

### 5.2 Sub-Part 탭 (`?tab=parts`)

#### 5.2.1 Part 데이터 구조

```typescript
interface PartConfig {
  id: string;
  name: string;               // Part name
  description?: string;
  projectId: string;
  leaderId?: string;           // Part leader user ID
  leaderName?: string;
  status: "ACTIVE" | "INACTIVE" | "COMPLETED";
  startDate?: string;
  endDate?: string;
  progress: number;
  // Extended fields (not in R2dbcPart but needed for admin UI)
  manMonth?: number;           // M/M
  headCount?: number;          // Number of people
  members: PartMemberConfig[];
}

interface PartMemberConfig {
  userId: string;
  userName: string;
  position: string;            // Job title
  manMonth: number;            // Individual M/M allocation
  role: string;                // Project role (DEVELOPER, QA, etc.)
}
```

#### 5.2.2 Part CRUD Operations

| Operation | API | 권한 |
|-----------|-----|------|
| List Parts | `GET /api/admin/project/:projectId/parts` | `admin_project` |
| Get Part Detail | `GET /api/admin/project/:projectId/parts/:partId` | `admin_project` |
| Create Part | `POST /api/admin/project/:projectId/parts` | `admin_project` (PM only) |
| Update Part | `PUT /api/admin/project/:projectId/parts/:partId` | `admin_project` (PM only) |
| Delete Part | `DELETE /api/admin/project/:projectId/parts/:partId` | `admin_project` (PM only) |
| Add Member | `POST /api/admin/project/:projectId/parts/:partId/members` | `admin_project` (PM only) |
| Remove Member | `DELETE /api/admin/project/:projectId/parts/:partId/members/:userId` | `admin_project` (PM only) |

### 5.3 조직도 탭 (`?tab=org-chart`)

#### 5.3.1 조직도 데이터 구조

```typescript
interface OrgChartNode {
  userId: string;
  userName: string;
  role: string;                // PM, Part Leader, Member
  position?: string;           // Job title
  partId?: string;
  partName?: string;
  children: OrgChartNode[];
}

interface ProjectOrgChart {
  projectId: string;
  projectName: string;
  root: OrgChartNode;          // PM node at root
}
```

#### 5.3.2 조직도 렌더링 규칙

- Root: 수행PM
- Level 1: Part Leaders (파트리더)
- Level 2: Part Members (팀원)
- Export: PNG, PDF format support
- Interactive: node click shows member detail in Right Panel

### 5.4 Phase 설정 탭 (`?tab=phases`)

#### 5.4.1 Phase 데이터 구조

```typescript
interface PhaseConfig {
  id: string;
  projectId: string;
  name: string;
  orderNum: number;
  status: "NOT_STARTED" | "IN_PROGRESS" | "COMPLETED" | "ON_HOLD";
  gateStatus?: "PENDING" | "SUBMITTED" | "APPROVED" | "REJECTED";
  startDate?: string;
  endDate?: string;
  progress: number;
  description?: string;
  parentId?: string;           // Self-FK for parent phase hierarchy
  trackType: "AI" | "SI" | "COMMON";
  // Admin-specific extended fields
  relatedParts: string[];      // Part IDs associated with this phase
  relatedTaskCount: number;    // Number of tasks in this phase
}
```

#### 5.4.2 Phase CRUD Operations

| Operation | API | 권한 |
|-----------|-----|------|
| List Phases | `GET /api/admin/project/:projectId/phases` | `admin_project` |
| Create Phase | `POST /api/admin/project/:projectId/phases` | `admin_project` (PM only) |
| Update Phase | `PUT /api/admin/project/:projectId/phases/:phaseId` | `admin_project` (PM only) |
| Delete Phase | `DELETE /api/admin/project/:projectId/phases/:phaseId` | `admin_project` (PM only) |
| Reorder Phases | `PUT /api/admin/project/:projectId/phases/reorder` | `admin_project` (PM only) |

> **Phase hierarchy**: `parent_id` self-FK is used for parent/child phase grouping.
> Parent phases aggregate progress from child phases. Admin UI shows the hierarchy
> as a collapsible tree in the Gantt-like timeline view.

### 5.5 역할-권한 매트릭스 탭 (`?tab=roles`)

#### 5.5.1 매트릭스 데이터 구조

```typescript
interface RoleCapabilityMatrix {
  projectId: string;
  roles: ProjectRoleDefinition[];
  capabilities: CapabilityDefinition[];
  mappings: RoleCapabilityMapping[];
}

interface ProjectRoleDefinition {
  role: "SPONSOR" | "PMO_HEAD" | "PM" | "DEVELOPER" | "QA" | "BUSINESS_ANALYST" | "MEMBER";
  label: string;
  description: string;
  isSystem: boolean;           // true = cannot delete
}

interface CapabilityDefinition {
  key: string;                 // e.g., "view_backlog"
  label: string;               // e.g., "Backlog view"
  category: string;            // e.g., "Backlog", "Kanban", "Admin"
  description: string;
}

interface RoleCapabilityMapping {
  role: string;
  capability: string;
  granted: boolean;
  inherited: boolean;          // true = inherited from parent role
  inheritedFrom?: string;      // v2.1: source role (e.g., "PMO_HEAD")
  overridden: boolean;         // v2.1: true = explicit override of inherited value
}

/**
 * v2.1 Role Hierarchy (inheritance chain)
 * MEMBER < BUSINESS_ANALYST < QA < DEVELOPER < PM < PMO_HEAD < SPONSOR
 *
 * Inheritance rules:
 * - Child role inherits all parent capabilities by default
 * - Inherited cells show gray [v] with tooltip: "Inherited from: {parentRole}"
 * - PM can enable "Override Mode" to grant/revoke inherited caps (overridden=true)
 * - Override cells show orange border to distinguish from direct grants
 */
interface RoleHierarchy {
  chain: string[];             // ordered from lowest to highest
  overrideEnabled: boolean;    // PM toggle for allowing inheritance exceptions
}
```

#### 5.5.2 매트릭스 API

| Operation | API | 권한 |
|-----------|-----|------|
| Get Matrix | `GET /api/admin/project/:projectId/role-matrix` | `admin_project` |
| Update Matrix | `PUT /api/admin/project/:projectId/role-matrix` | `admin_project` (PM only) |
| Reset to Default | `POST /api/admin/project/:projectId/role-matrix/reset` | `admin_project` (PM only) |

### 5.6 칸반/Sprint 설정 탭 (`?tab=workflow`)

#### 5.6.1 Workflow Configuration

```typescript
interface WorkflowConfig {
  projectId: string;
  kanban: KanbanConfig;
  sprint: SprintConfig;
}

interface KanbanConfig {
  wipLimits: {
    column: string;            // "TODO" | "IN_PROGRESS" | "IN_REVIEW" | "DONE"
    limit: number;             // 0 = unlimited
  }[];
  enableBlockedStatus: boolean;
  enableSwimLanes: boolean;
  swimLaneField?: "part" | "assignee" | "priority";
}

interface SprintConfig {
  defaultDuration: number;     // days (default: 14)
  spCapacity: number;          // Story Points per sprint
  autoCloseIncomplete: boolean; // auto-move incomplete items to next sprint
  retrospectiveEnabled: boolean;
  velocityWindow: number;      // sprints to average for velocity (default: 3)
}
```

### 5.7 알림 설정 탭 (`?tab=notifications`)

#### 5.7.1 Notification Configuration

```typescript
interface NotificationConfig {
  projectId: string;
  rules: NotificationRule[];
}

interface NotificationRule {
  id: string;
  event: NotificationEvent;
  channels: ("in_app" | "email" | "slack")[];
  recipients: NotificationRecipient;
  enabled: boolean;
}

type NotificationEvent =
  | "task_assigned"
  | "task_status_changed"
  | "task_overdue"
  | "sprint_started"
  | "sprint_ended"
  | "deliverable_submitted"
  | "deliverable_approved"
  | "deliverable_rejected"
  | "issue_created"
  | "issue_escalated"
  | "phase_started"
  | "phase_completed"
  | "decision_requested"
  | "decision_approved"
  | "wip_limit_exceeded";

interface NotificationRecipient {
  type: "role" | "user" | "part";
  value: string;               // role name, userId, or partId
}
```

---

## 6. 시스템 설정 상세

### 6.1 사용자 관리 탭 (`?tab=users`)

#### 6.1.1 사용자 데이터 구조

```typescript
interface UserAdminView {
  id: string;
  email: string;
  name: string;
  role: "SPONSOR" | "PMO_HEAD" | "PM" | "DEVELOPER" | "QA"
       | "BUSINESS_ANALYST" | "AUDITOR" | "ADMIN";
  department?: string;
  active: boolean;
  lastLoginAt?: string;
  createdAt: string;
  // Extended view for admin
  projectMemberships: {
    projectId: string;
    projectName: string;
    projectRole: string;
    partName?: string;
  }[];
}
```

#### 6.1.2 사용자 CRUD API

| Operation | API | Method |
|-----------|-----|--------|
| List Users | `/api/admin/system/users` | GET |
| Get User | `/api/admin/system/users/:userId` | GET |
| Create User | `/api/admin/system/users` | POST |
| Update User | `/api/admin/system/users/:userId` | PUT |
| Deactivate User | `/api/admin/system/users/:userId/deactivate` | POST |
| Reactivate User | `/api/admin/system/users/:userId/reactivate` | POST |
| Reset Password | `/api/admin/system/users/:userId/reset-password` | POST |

#### 6.1.3 사용자 생성 폼 필드

| 필드 | 타입 | 필수 | Validation |
|------|------|------|-----------|
| 이름 | `text` | Y | 2~50자 |
| 이메일 | `email` | Y | 이메일 형식, 중복 불가 |
| 초기 비밀번호 | `password` | Y | 8자 이상, 영문+숫자+특수문자 |
| 시스템 역할 | `select` | Y | UserRole enum |
| 부서 | `text` | N | 자유 입력 |
| 활성 상태 | `toggle` | Y | default: true |

### 6.2 역할 관리 탭 (`?tab=roles`)

#### 6.2.1 시스템 역할 정의

```typescript
interface SystemRole {
  role: string;
  label: string;
  description: string;
  isSystem: boolean;           // ADMIN, AUDITOR = true (cannot delete)
  defaultCapabilities: string[];
  userCount: number;           // number of users with this role
}
```

> **시스템 역할과 프로젝트 역할의 차이**:
> - 시스템 역할 (R2dbcUser.UserRole): ADMIN, AUDITOR -- global scope
> - 프로젝트 역할 (R2dbcProjectMember.ProjectRole): SPONSOR, PMO_HEAD, PM, DEVELOPER, QA, BA, MEMBER -- project scope
> - 시스템 설정에서는 시스템 역할만 관리
> - 프로젝트 설정에서는 프로젝트 역할-권한 매핑을 관리

### 6.3 조직 구조 탭 (`?tab=org-structure`)

#### 6.3.1 조직 구조 데이터

```typescript
interface OrganizationStructure {
  departments: DepartmentNode[];
}

interface DepartmentNode {
  id: string;
  name: string;
  parentId?: string;
  headUserId?: string;
  headUserName?: string;
  memberCount: number;
  children: DepartmentNode[];
}
```

### 6.4 시스템 구성 탭 (`?tab=config`)

#### 6.4.1 시스템 구성 항목

```typescript
interface SystemConfig {
  general: {
    systemName: string;
    defaultLanguage: "ko" | "en";
    sessionTimeout: number;    // minutes
    maxLoginAttempts: number;
    passwordPolicy: {
      minLength: number;
      requireUpperCase: boolean;
      requireNumber: boolean;
      requireSpecialChar: boolean;
      expirationDays: number;
    };
  };
  jwt: {
    accessTokenExpiry: number;  // hours (default: 24)
    refreshTokenExpiry: number; // days
  };
  storage: {
    maxUploadSize: number;     // MB
    allowedFileTypes: string[];
  };
}
```

### 6.5 통합 설정 탭 (`?tab=integrations`)

#### 6.5.1 통합 서비스 데이터 구조

```typescript
interface IntegrationService {
  id: string;
  name: string;                // "AI Service", "Neo4j", "Redis", "PostgreSQL"
  type: "ai" | "graph_db" | "cache" | "rdb";
  config: Record<string, string>;  // URL, credentials (masked), etc.
  status: IntegrationStatus;
  lastCheckedAt: string;
  latency?: number;            // ms
  metadata?: Record<string, string>; // version, model name, etc.
}

interface IntegrationStatus {
  state: "OK" | "WARN" | "ERROR" | "UNKNOWN";
  message?: string;
  details?: string;
}
```

#### 6.5.1a 통합 설정 런타임 안전장치 (v2.1)

> v2.0의 "연결 테스트 성공 전 저장 차단"을 3단계로 강화한다.

```typescript
/** v2.1 Integration Safety Controls */
interface IntegrationSafetyConfig {
  /** N회 측정 테스트 — 1회 ping 대신 연속 N회 측정 */
  connectionTest: {
    rounds: number;           // default: 5
    metrics: {
      avgLatency: number;     // ms
      maxLatency: number;     // ms
      errorRate: number;      // 0~1
      successCount: number;
    };
    passThreshold: {
      maxAvgLatency: number;  // default: 500ms
      maxErrorRate: number;   // default: 0.0 (no errors)
    };
  };

  /** 설정 버전 롤백 — 최근 3개 버전 보관 */
  configVersions: {
    currentVersion: number;
    history: {
      version: number;
      config: Record<string, string>;
      appliedAt: string;
      appliedBy: string;
    }[];
    maxVersions: 3;
  };

  /** Change Freeze 모드 — 장애 대응 중 설정 변경 차단 */
  changeFreezeMode: {
    enabled: boolean;
    enabledBy?: string;
    enabledAt?: string;
    reason?: string;
    // ADMIN만 Freeze 설정/해제 가능
  };

  /** 적용 방식 선택 */
  applyStrategy: "immediate" | "on_next_restart";
}
```

> **운영 시나리오**:
> 1. URL/자격증명 변경 → N회 테스트 실행 → 5회 중 5회 성공 + 평균 지연 < 500ms → 저장 허용
> 2. 테스트 실패 → "테스트 실패: 3/5 성공, 평균 지연 1200ms" → 저장 차단 + 원인 표시
> 3. 장애 대응 중 → ADMIN이 Change Freeze ON → 모든 통합 설정 변경 UI disabled
> 4. 롤백 필요 → 이전 설정 선택 → 1클릭 복원 → N회 테스트 자동 실행 → 통과 시 적용

#### 6.5.2 통합 서비스 API

| Operation | API | Method |
|-----------|-----|--------|
| List Services | `/api/admin/system/integrations` | GET |
| Health Check | `/api/admin/system/integrations/:serviceId/health` | GET |
| Update Config | `/api/admin/system/integrations/:serviceId` | PUT |
| Test Connection | `/api/admin/system/integrations/:serviceId/test` | POST |
| Flush Redis | `/api/admin/system/integrations/redis/flush` | POST |

#### 6.5.3 Service Configuration Reference

| Service | Config Key | Default | Description |
|---------|-----------|---------|-------------|
| AI Service | `AI_SERVICE_URL` | `http://llm-service:8000` | LLM service endpoint |
| AI Service | `MODEL_PATH` | `./models/google.gemma-3-12b-pt.Q5_K_M.gguf` | Model file path |
| Neo4j | `NEO4J_URI` | `bolt://neo4j:7687` | Graph DB connection |
| Redis | `REDIS_HOST` | `redis:6379` | Cache server |
| PostgreSQL | `DB_HOST` | `postgres:5433` | Primary database |

### 6.6 감사 로그 탭 (`?tab=audit-log`)

#### 6.6.0 감사 로그 경계 규칙 (v2.1)

> **프로젝트 로그 vs 시스템 로그** 경계를 명확히 정의한다.

| 이벤트 범위 | 기록 대상 | 예시 |
|------------|----------|------|
| 프로젝트 범위 변경 (Part/Phase/RoleMatrix/Workflow/Notification/ProjectInfo) | **프로젝트 감사 로그만** (`/api/admin/project/:id/audit-log`) | Phase 삭제, 역할-권한 변경 |
| 계정/전역 설정 변경 (User CRUD, 시스템 역할, 시스템 구성, 비밀번호 정책) | **시스템 감사 로그만** (`/api/admin/system/audit-logs`) | 사용자 비활성화, JWT 만료 변경 |
| 통합 서비스/백업/복원 변경 | **시스템 감사 로그만** | AI_SERVICE_URL 변경, 백업 복원 |
| 모델 관리 (등록/활성화/핫스왑) | **시스템 감사 로그만** | 모델 핫스왑 |
| 로그인/로그아웃 | **시스템 감사 로그만** | 로그인 실패 |

> **교차 참조 규칙**: 프로젝트 로그에 기록된 이벤트는 시스템 로그에 **남기지 않는다** (노이즈 감소).
> 시스템 로그에서 프로젝트 변경을 추적하려면 프로젝트 감사 로그로 deep link한다.

#### 6.6.1 감사 로그 데이터 구조

```typescript
interface AuditLogEntry {
  id: string;
  timestamp: string;           // ISO datetime
  userId: string;
  userName: string;
  action: "CREATE" | "UPDATE" | "DELETE" | "LOGIN" | "LOGOUT" | "EXPORT"
        | "ACTIVATE" | "DEACTIVATE" | "HOT_SWAP" | "RESTORE";  // v2.1 확장
  scope: "PROJECT" | "SYSTEM";  // v2.1: 로그 경계 구분
  targetType: "USER" | "PROJECT" | "PART" | "PHASE" | "ROLE" | "CONFIG"
            | "INTEGRATION" | "MODEL" | "BACKUP";  // v2.1: MODEL, BACKUP 추가
  targetId?: string;
  targetName?: string;
  changes?: AuditChange[];
  ipAddress?: string;
  userAgent?: string;
}

/**
 * v2.1: fieldPath 표준 규격
 *
 * 규칙: {entity}.{field} 또는 {entity}.{nested}.{field}
 * 예시:
 *   "project.end_date"
 *   "project_profile.customer_name"
 *   "workflow.kanban.wipLimits[IN_PROGRESS]"
 *   "role_matrix.PM.manage_issues"
 *   "integration.ai_service.url"
 *   "model.gemma-3-12b.status"
 *
 * 민감정보: 값은 항상 "[REDACTED]"로 마스킹
 *   "integration.neo4j.password" → old: "[REDACTED]", new: "[REDACTED]"
 */
interface AuditChange {
  fieldPath: string;           // v2.1: dot-notation 규칙 기반 경로 (기존 field → fieldPath)
  oldValue?: string | null;    // v2.1: JSON 직렬화 권장 (구조 보존)
  newValue?: string | null;
  sensitive: boolean;          // v2.1: true면 old/new 값이 "[REDACTED]"
}
```

#### 6.6.2 감사 로그 API

| Operation | API | Method |
|-----------|-----|--------|
| Search Logs | `/api/admin/system/audit-logs` | GET |
| Get Log Detail | `/api/admin/system/audit-logs/:logId` | GET |
| Export Logs | `/api/admin/system/audit-logs/export` | GET |

Query Parameters:
- `q`: full-text search
- `dateFrom`, `dateTo`: date range filter
- `action`: action type filter
- `userId`: user filter
- `targetType`: target type filter
- `page`, `size`: pagination

### 6.7 시스템 모니터링 탭 (`?tab=health`)

#### 6.7.1 시스템 헬스 데이터 구조

```typescript
interface SystemHealth {
  uptime: string;              // "32d 14h 22m"
  cpu: ResourceMetric;
  memory: ResourceMetric;
  disk: ResourceMetric;
  services: ServiceHealthItem[];
  backup: BackupStatus;
}

interface ResourceMetric {
  usage: number;               // 0~100 (%)
  status: "OK" | "WARN" | "CRITICAL";
  threshold: { warn: number; critical: number };
}

interface ServiceHealthItem {
  name: string;
  status: "OK" | "WARN" | "ERROR" | "UNKNOWN";
  latency?: number;            // ms
  lastCheckedAt: string;
  version?: string;
  details?: string;
}

interface BackupStatus {
  lastBackupAt?: string;
  backupSize?: string;         // e.g., "2.4 GB"
  schedule: string;            // e.g., "daily 03:00"
  nextBackupAt?: string;
}
```

#### 6.7.1a 백업/복원 안전 절차 (v2.1)

> `POST /restore`는 시스템 전체에 영향을 주는 최고 위험 엔드포인트이다.
> 단순 ConfirmDialog가 아닌 **강한 확인 절차**를 적용한다.

```typescript
/** v2.1 Restore Safety Flow */
interface RestoreRequest {
  backupId: string;
  /** ADMIN이 직접 입력하는 확인 코드 (서버가 생성, UI에 표시) */
  confirmationCode: string;    // e.g., "RESTORE-2026-0208-A3F2"
}

interface RestoreJob {
  jobId: string;
  status: "PENDING" | "PRE_BACKUP" | "RESTORING" | "VERIFYING" | "COMPLETED" | "FAILED" | "ROLLED_BACK";
  progress: number;            // 0~100
  startedAt: string;
  estimatedDuration?: string;
  logs: RestoreLogEntry[];
}

interface RestoreLogEntry {
  timestamp: string;
  level: "INFO" | "WARN" | "ERROR";
  message: string;
}
```

> **복원 플로우**:
> 1. ADMIN이 백업 선택 → 확인 코드가 화면에 표시됨
> 2. ADMIN이 코드를 직접 입력 (복사-붙여넣기 차단) → 일치해야 진행
> 3. 서버가 **현재 상태를 자동 백업** (pre-restore snapshot)
> 4. 비동기 Job으로 복원 시작 → UI에 진행률/로그 스트리밍
> 5. 복원 완료 → 서비스 헬스 체크 자동 실행 → 전체 통과 시 COMPLETED
> 6. 헬스 체크 실패 → 자동 롤백 (pre-restore snapshot으로) → ROLLED_BACK
> 7. 복원 후 Redis 캐시 자동 플러시 + JWT 세션 전체 만료

#### 6.7.2 시스템 헬스 API

| Operation | API | Method |
|-----------|-----|--------|
| Get Health | `/api/admin/system/health` | GET |
| Trigger Backup | `/api/admin/system/backup` | POST |
| Restore Backup | `/api/admin/system/restore` | POST |
| Get Backup List | `/api/admin/system/backups` | GET |

### 6.8 모델 관리 탭 (`?tab=models`) (v2.1)

> AI/LLM 모델의 등록, 활성화/비활성화, 핫스왑, 성능 모니터링을 통합 관리한다.
> 시스템에는 L1(Fast)과 L2(Quality) 두 슬롯이 존재하며, 각 슬롯에 하나의 활성 모델만 배치된다.

#### 6.8.1 모델 데이터 구조

```typescript
interface ModelRegistryEntry {
  id: string;
  name: string;                // e.g., "Gemma-3-12B-Q5_K_M"
  displayName: string;         // e.g., "Gemma-3-12B"
  slot: "L1" | "L2";          // Fast inference / Quality inference
  status: ModelStatus;
  filePath: string;            // e.g., "./models/google.gemma-3-12b-pt.Q5_K_M.gguf"
  fileSize: string;            // e.g., "8.2 GB"
  quantization?: string;       // e.g., "Q5_K_M"
  contextLength: number;       // e.g., 8192
  gpuMemory?: string;          // e.g., "8.2 GB"
  loadTime?: number;           // seconds
  registeredAt: string;
  registeredBy: string;
  activatedAt?: string;
  version: number;             // optimistic lock
}

type ModelStatus = "REGISTERED" | "LOADING" | "ACTIVE" | "INACTIVE" | "ERROR";

interface ModelPerformanceMetrics {
  modelId: string;
  window: "5min" | "30min" | "1h" | "24h";
  avgLatency: number;          // ms
  p95Latency: number;          // ms
  p99Latency: number;          // ms
  requestsPerMinute: number;
  errorRate: number;           // 0~1
  tokensThroughput: number;    // tokens/sec
}
```

#### 6.8.2 모델 상태 전이 (서버 중심)

```
REGISTERED → LOADING → ACTIVE
                ↓         ↓
              ERROR    INACTIVE
                         ↓
                      LOADING → ACTIVE (re-activation)
```

> **핫스왑**: 같은 슬롯의 새 모델을 LOADING 상태로 올린 뒤, 로딩 완료 시 기존 모델을 INACTIVE로 전환하고
> 새 모델을 ACTIVE로 전환한다. 전환 중 요청은 기존 모델이 계속 처리한다 (zero-downtime).

#### 6.8.3 모델 CRUD API

| Operation | API | Method | 권한 |
|-----------|-----|--------|------|
| List Models | `/api/admin/system/models` | GET | `admin_models` |
| Get Model Detail | `/api/admin/system/models/:modelId` | GET | `admin_models` |
| Register Model | `/api/admin/system/models` | POST | `admin_models` |
| Activate Model | `/api/admin/system/models/:modelId/activate` | POST | `admin_models` |
| Deactivate Model | `/api/admin/system/models/:modelId/deactivate` | POST | `admin_models` |
| Hot-Swap Model | `/api/admin/system/models/:modelId/hot-swap` | POST | `admin_models` |
| Delete Model | `/api/admin/system/models/:modelId` | DELETE | `admin_models` |
| Get Performance | `/api/admin/system/models/:modelId/metrics` | GET | `admin_models` |
| Get Active Models | `/api/admin/system/models/active` | GET | `admin_system` |

#### 6.8.4 모델 등록 폼 필드

| 필드 | 타입 | 필수 | Validation |
|------|------|------|-----------|
| 모델명 | `text` | Y | 2~100자, 중복 불가 |
| 슬롯 | `select` | Y | `L1` / `L2` |
| 파일 경로 | `text` | Y | 서버 로컬 경로, 파일 존재 확인 |
| 양자화 | `text` | N | e.g., Q5_K_M |
| 컨텍스트 길이 | `number` | Y | 512~131072 |
| 설명 | `textarea` | N | 자유 입력 |

---

## 7. 데이터 구조 / API 종합

### 7.1 프로젝트 설정 API Summary

```
Base: /api/admin/project/:projectId

GET    /                              → Project general info
PUT    /                              → Update project info
GET    /parts                         → List parts
POST   /parts                         → Create part
PUT    /parts/:partId                 → Update part
DELETE /parts/:partId                 → Delete part
POST   /parts/:partId/members         → Add part member
DELETE /parts/:partId/members/:userId  → Remove part member
GET    /org-chart                     → Organization chart data
GET    /phases                        → List phases
POST   /phases                        → Create phase
PUT    /phases/:phaseId               → Update phase
DELETE /phases/:phaseId               → Delete phase
PUT    /phases/reorder                → Reorder phases
GET    /role-matrix                   → Role-capability matrix
PUT    /role-matrix                   → Update role-capability matrix
POST   /role-matrix/reset             → Reset to defaults
GET    /workflow                      → Kanban/Sprint config
PUT    /workflow                      → Update workflow config
GET    /notifications                 → Notification rules
PUT    /notifications                 → Update notification rules
GET    /audit-log                     → Project-level audit log

# v2.1 additions
GET    /:resource/impact              → Impact analysis preview (Part, Phase, RoleMatrix)
```

> **v2.1 Optimistic Lock**: 모든 PUT 요청은 `{ ..., version: N }` 필드를 포함해야 한다.
> 서버는 현재 version과 비교하여 불일치 시 `409 Conflict` + 현재 값을 응답한다.

### 7.2 시스템 설정 API Summary

```
Base: /api/admin/system

GET    /users                         → List users
POST   /users                         → Create user
GET    /users/:userId                 → Get user detail
PUT    /users/:userId                 → Update user
POST   /users/:userId/deactivate      → Deactivate user
POST   /users/:userId/reactivate      → Reactivate user
POST   /users/:userId/reset-password  → Reset password
GET    /roles                         → List system roles
PUT    /roles/:role                   → Update system role
GET    /org-structure                 → Organization structure
PUT    /org-structure                 → Update organization
GET    /config                        → System configuration
PUT    /config                        → Update system config
GET    /integrations                  → List integration services
PUT    /integrations/:serviceId       → Update integration config
POST   /integrations/:serviceId/test  → Test connection
GET    /integrations/:serviceId/health → Service health check
POST   /integrations/redis/flush      → Flush Redis cache
GET    /audit-logs                    → System audit logs
GET    /audit-logs/:logId             → Audit log detail
GET    /audit-logs/export             → Export audit logs (CSV)
GET    /health                        → System health overview
POST   /backup                        → Trigger manual backup
POST   /restore                       → Restore from backup (v2.1: job-based + confirm code)
GET    /backups                       → List backups
GET    /restore-jobs/:jobId           → Restore job status (v2.1)

# v2.1: Model Management API (requires admin_models capability)
GET    /models                        → List registered models
POST   /models                        → Register new model
GET    /models/:modelId               → Get model detail
POST   /models/:modelId/activate      → Activate model (load into slot)
POST   /models/:modelId/deactivate    → Deactivate model (unload)
POST   /models/:modelId/hot-swap      → Hot-swap with current active model
DELETE /models/:modelId               → Delete model registration
GET    /models/:modelId/metrics       → Model performance metrics
GET    /models/active                 → Currently active models per slot

# v2.1: Integration Safety API
POST   /integrations/:serviceId/test-n → N-round connection test
GET    /integrations/:serviceId/config-versions → Config version history
POST   /integrations/:serviceId/rollback → Rollback to previous config version
PUT    /integrations/change-freeze    → Toggle Change Freeze mode
```

### 7.3 Backend Security Annotations

```java
// v2.1: Capability-based auth (no more Role checks — all through granular capabilities)

// ProjectAdminController.java
@RestController
@RequestMapping("/api/admin/project/{projectId}")
public class ProjectAdminController {

    @GetMapping
    @PreAuthorize("@projectSecurity.hasCapability(#projectId, 'admin_project_view')")
    public Mono<ProjectAdminView> getProjectSettings(
        @PathVariable String projectId) { ... }

    @PutMapping
    @PreAuthorize("@projectSecurity.hasCapability(#projectId, 'admin_project_edit_general')")
    public Mono<ProjectAdminView> updateProjectSettings(
        @PathVariable String projectId,
        @RequestBody ProjectUpdateRequest request) { ... }

    @PostMapping("/parts")
    @PreAuthorize("@projectSecurity.hasCapability(#projectId, 'admin_project_manage_parts')")
    public Mono<PartConfig> createPart(
        @PathVariable String projectId,
        @RequestBody PartCreateRequest request) { ... }

    @PutMapping("/phases/{phaseId}")
    @PreAuthorize("@projectSecurity.hasCapability(#projectId, 'admin_project_manage_phases')")
    public Mono<PhaseConfig> updatePhase(
        @PathVariable String projectId,
        @PathVariable String phaseId,
        @RequestBody PhaseUpdateRequest request) { ... }

    @PutMapping("/role-matrix")
    @PreAuthorize("@projectSecurity.hasCapability(#projectId, 'admin_project_manage_role_matrix')")
    public Mono<RoleCapabilityMatrix> updateRoleMatrix(
        @PathVariable String projectId,
        @RequestBody RoleMatrixUpdateRequest request) { ... }

    // v2.1: Impact analysis (shared pattern)
    @GetMapping("/phases/{phaseId}/impact")
    @PreAuthorize("@projectSecurity.hasCapability(#projectId, 'admin_project_manage_phases')")
    public Mono<ImpactAnalysis> getPhaseDeleteImpact(
        @PathVariable String projectId,
        @PathVariable String phaseId) { ... }
}

// SystemAdminController.java
@RestController
@RequestMapping("/api/admin/system")
@PreAuthorize("hasRole('ADMIN')")
public class SystemAdminController {

    @GetMapping("/users")
    public Flux<UserAdminView> listUsers() { ... }

    @PostMapping("/users")
    public Mono<UserAdminView> createUser(
        @RequestBody UserCreateRequest request) { ... }

    @GetMapping("/health")
    public Mono<SystemHealth> getSystemHealth() { ... }

    // v2.1: Restore with job-based safety
    @PostMapping("/restore")
    public Mono<RestoreJob> restoreBackup(
        @RequestBody RestoreRequest request) { ... }
}

// v2.1: ModelAdminController.java (separate controller, separate capability)
@RestController
@RequestMapping("/api/admin/system/models")
@PreAuthorize("@systemSecurity.hasCapability('admin_models')")
public class ModelAdminController {

    @GetMapping
    public Flux<ModelRegistryEntry> listModels() { ... }

    @PostMapping
    public Mono<ModelRegistryEntry> registerModel(
        @RequestBody ModelRegisterRequest request) { ... }

    @PostMapping("/{modelId}/hot-swap")
    public Mono<ModelRegistryEntry> hotSwapModel(
        @PathVariable String modelId) { ... }

    @GetMapping("/{modelId}/metrics")
    public Mono<ModelPerformanceMetrics> getMetrics(
        @PathVariable String modelId,
        @RequestParam(defaultValue = "30min") String window) { ... }
}
```

```typescript
// v2.1: ImpactAnalysis shared response type
interface ImpactAnalysis {
  targetType: "PART" | "PHASE" | "USER" | "ROLE_MATRIX";
  targetId: string;
  targetName: string;
  affectedItems: {
    type: string;             // "Task", "WBS", "Sprint", "PartLeader", etc.
    count: number;
    samples: string[];        // first 5 names for preview
  }[];
  autoActions: {
    action: string;           // "unassign_tasks", "deactivate_child_phases", etc.
    description: string;
    itemCount: number;
  }[];
  requiresConfirmation: boolean;
  confirmationChecks: string[]; // checkbox texts user must agree to
}
```

---

## 8. 컴포넌트 분해

### 8.1 폴더 구조

```
features/
  admin/
    pages/
      ProjectAdminPage.tsx           ← Tab-based project settings
      SystemAdminPage.tsx            ← Tab-based system settings
    layout/
      AdminTabLayout.tsx             ← Shared tab layout shell
      AdminPageHeader.tsx            ← Page header with save/cancel
    components/
      // Project Settings - General
      ProjectInfoForm.tsx            ← Project basic info form
      PmoSettingsForm.tsx            ← PMO manager assignments
      // Project Settings - Parts
      PartListTable.tsx              ← Part list with CRUD
      PartDetailPanel.tsx            ← Part detail (Right Panel)
      PartMemberList.tsx             ← Part member management
      AddPartDialog.tsx              ← Create part dialog
      AddMemberDialog.tsx            ← Add member to part dialog
      // Project Settings - Org Chart
      OrgChartTree.tsx               ← Organization chart tree diagram
      OrgChartNode.tsx               ← Single org chart node
      OrgChartExport.tsx             ← Export buttons (PNG/PDF)
      // Project Settings - Phase
      PhaseConfigTimeline.tsx        ← Phase Gantt-like timeline
      PhaseDetailPanel.tsx           ← Phase detail (Right Panel)
      AddPhaseDialog.tsx             ← Create phase dialog
      PhaseTrackFilter.tsx           ← AI/SI/COMMON filter
      // Project Settings - Role Matrix
      RoleMatrixEditor.tsx           ← Role-Capability checkbox matrix
      RoleMatrixResetDialog.tsx      ← Reset confirmation
      // Project Settings - Workflow
      KanbanConfigForm.tsx           ← WIP limits, swimlanes
      SprintConfigForm.tsx           ← Sprint duration, SP capacity
      // Project Settings - Notifications
      NotificationRuleList.tsx       ← Notification rule list
      NotificationRuleEditor.tsx     ← Single rule editor
      // System Settings - Users
      UserManagementTable.tsx        ← User list with search/filter
      UserDetailPanel.tsx            ← User detail (Right Panel)
      CreateUserDialog.tsx           ← Create user dialog
      UserProjectMemberships.tsx     ← User's project list
      // System Settings - Roles
      SystemRoleList.tsx             ← System role list
      SystemRoleEditor.tsx           ← Role editor
      // System Settings - Org Structure
      OrgStructureTree.tsx           ← Department hierarchy
      DepartmentEditor.tsx           ← Department editor
      // System Settings - Config
      SystemConfigForm.tsx           ← System-wide configuration form
      PasswordPolicyForm.tsx         ← Password policy settings
      // System Settings - Integrations
      IntegrationServiceCards.tsx    ← Service health overview cards
      IntegrationConfigForm.tsx      ← Service configuration form
      ConnectionTestButton.tsx       ← Test connection button
      // System Settings - Audit Log
      AuditLogTable.tsx              ← Audit log table with search
      AuditLogDetailPanel.tsx        ← Log detail with change diff
      AuditLogExport.tsx             ← Export CSV button
      // System Settings - Health
      SystemHealthCards.tsx           ← CPU/Memory/Disk cards
      ServiceStatusTable.tsx         ← Service status matrix
      BackupStatusPanel.tsx          ← Backup status and controls
      // System Settings - Models (v2.1)
      ModelRegistryTable.tsx         ← Model list with status badges
      ModelDetailPanel.tsx           ← Model detail (Right Panel)
      ModelRegisterDialog.tsx        ← Register new model dialog
      ModelPerformanceChart.tsx      ← Latency/throughput charts (30min window)
      ModelHotSwapDialog.tsx         ← Hot-swap confirmation + progress
      ActiveModelSlots.tsx           ← L1/L2 active model summary cards
      // Shared
      ChangeHistoryPanel.tsx         ← Change history for Right Panel
      UnsavedChangesDialog.tsx       ← Navigation guard dialog
      ImpactPreviewDialog.tsx        ← v2.1: Shared impact analysis dialog
      ConflictMergeDialog.tsx        ← v2.1: Optimistic lock conflict resolution
      ConnectionNTestPanel.tsx       ← v2.1: N-round connection test results
      ChangeFreezeBar.tsx            ← v2.1: Change Freeze mode banner
    config/
      adminTabs.ts                   ← Tab definitions for both pages
    api/
      projectAdminApi.ts             ← Project settings API calls
      systemAdminApi.ts              ← System settings API calls
      modelAdminApi.ts               ← v2.1: Model management API calls
    hooks/
      useProjectAdmin.ts             ← TanStack Query for project settings
      useSystemAdmin.ts              ← TanStack Query for system settings
      useModelAdmin.ts               ← v2.1: TanStack Query for model management
      useUnsavedChanges.ts           ← Unsaved changes detection hook
      useAuditLog.ts                 ← Audit log search/filter hook
      useOptimisticLock.ts           ← v2.1: Version conflict detection hook
      useImpactAnalysis.ts           ← v2.1: Impact preview before destructive actions
      useChangeFreezeGuard.ts        ← v2.1: Change Freeze mode check hook
```

### 8.2 Admin Tab Configuration

```typescript
// config/adminTabs.ts

interface AdminTab {
  key: string;
  label: string;
  icon: string;
  requiredCaps: Capability[];
  presetAccess: {
    preset: ViewModePreset;
    mode: "full" | "read-only" | "hidden";
  }[];
}

// v2.1: granular capabilities per tab
export const projectAdminTabs: AdminTab[] = [
  {
    key: "general",
    label: "기본 정보",
    icon: "InfoRounded",
    requiredCaps: ["admin_project_view"],        // v2.1: view for entry
    editCaps: ["admin_project_edit_general"],     // v2.1: edit for mutations
    presetAccess: [
      { preset: "PM_WORK", mode: "full" },
      { preset: "PMO_CONTROL", mode: "read-only" },  // PMO fields only via editCaps
    ],
  },
  {
    key: "parts",
    label: "Sub-Part",
    icon: "GroupsRounded",
    requiredCaps: ["admin_project_view"],
    editCaps: ["admin_project_manage_parts"],
    presetAccess: [
      { preset: "PM_WORK", mode: "full" },
      { preset: "PMO_CONTROL", mode: "read-only" },
    ],
  },
  {
    key: "org-chart",
    label: "조직도",
    icon: "AccountTreeRounded",
    requiredCaps: ["admin_project_view"],
    presetAccess: [
      { preset: "PM_WORK", mode: "full" },
      { preset: "PMO_CONTROL", mode: "read-only" },
    ],
  },
  {
    key: "phases",
    label: "Phase 설정",
    icon: "TimelineRounded",
    requiredCaps: ["admin_project_view"],
    editCaps: ["admin_project_manage_phases"],
    presetAccess: [
      { preset: "PM_WORK", mode: "full" },
      { preset: "PMO_CONTROL", mode: "read-only" },
    ],
  },
  {
    key: "roles",
    label: "역할-권한",
    icon: "SecurityRounded",
    requiredCaps: ["admin_project_view"],
    editCaps: ["admin_project_manage_role_matrix"],
    presetAccess: [
      { preset: "PM_WORK", mode: "full" },
      { preset: "PMO_CONTROL", mode: "read-only" },
    ],
  },
  {
    key: "workflow",
    label: "칸반/Sprint",
    icon: "ViewKanbanRounded",
    requiredCaps: ["admin_project_view"],
    editCaps: ["admin_project_manage_workflow"],
    presetAccess: [
      { preset: "PM_WORK", mode: "full" },
      { preset: "PMO_CONTROL", mode: "read-only" },
    ],
  },
  {
    key: "notifications",
    label: "알림 설정",
    icon: "NotificationsRounded",
    requiredCaps: ["admin_project_view"],
    editCaps: ["admin_project_manage_notifications"],
    presetAccess: [
      { preset: "PM_WORK", mode: "full" },
      { preset: "PMO_CONTROL", mode: "full" },  // PMO can edit own notifications
    ],
  },
];

// v2.1: PMO_CONTROL → ADMIN_OPS for system settings
export const systemAdminTabs: AdminTab[] = [
  {
    key: "users",
    label: "사용자 관리",
    icon: "PeopleRounded",
    requiredCaps: ["admin_system"],
    presetAccess: [
      { preset: "ADMIN_OPS", mode: "full" },
    ],
  },
  {
    key: "roles",
    label: "역할 관리",
    icon: "AdminPanelSettingsRounded",
    requiredCaps: ["admin_system"],
    presetAccess: [
      { preset: "ADMIN_OPS", mode: "full" },
    ],
  },
  {
    key: "org-structure",
    label: "조직 구조",
    icon: "CorporateFareRounded",
    requiredCaps: ["admin_system"],
    presetAccess: [
      { preset: "ADMIN_OPS", mode: "full" },
    ],
  },
  {
    key: "config",
    label: "시스템 구성",
    icon: "TuneRounded",
    requiredCaps: ["admin_system"],
    presetAccess: [
      { preset: "ADMIN_OPS", mode: "full" },
    ],
  },
  {
    key: "integrations",
    label: "통합 설정",
    icon: "IntegrationInstructionsRounded",
    requiredCaps: ["admin_system"],
    presetAccess: [
      { preset: "ADMIN_OPS", mode: "full" },
    ],
  },
  {
    key: "audit-log",
    label: "감사 로그",
    icon: "HistoryRounded",
    requiredCaps: ["admin_system"],
    presetAccess: [
      { preset: "ADMIN_OPS", mode: "full" },
    ],
  },
  {
    key: "health",
    label: "시스템 모니터링",
    icon: "MonitorHeartRounded",
    requiredCaps: ["admin_system"],
    presetAccess: [
      { preset: "ADMIN_OPS", mode: "full" },
    ],
  },
  {
    key: "models",
    label: "모델 관리",
    icon: "SmartToyRounded",
    requiredCaps: ["admin_models"],  // v2.1: separate capability
    presetAccess: [
      { preset: "ADMIN_OPS", mode: "full" },
    ],
  },
];
```

### 8.3 Page Component Pattern

```typescript
// pages/ProjectAdminPage.tsx

function ProjectAdminPage() {
  const { projectId } = useParams();
  const { viewMode } = useAccessContext();
  const [activeTab, setActiveTab] = useQueryParam("tab", "general");
  const { hasUnsavedChanges, confirmNavigation } = useUnsavedChanges();

  const tabConfig = projectAdminTabs.find(t => t.key === activeTab);
  const accessMode = tabConfig?.presetAccess.find(
    p => p.preset === viewMode
  )?.mode ?? "hidden";

  if (accessMode === "hidden") return <NoPermission />;

  const readOnly = accessMode === "read-only";

  return (
    <PageLayout
      title="프로젝트 설정"
      subtitle={projectName}
    >
      <AdminTabLayout
        tabs={projectAdminTabs}
        activeTab={activeTab}
        onTabChange={(tab) => {
          if (hasUnsavedChanges) {
            confirmNavigation(() => setActiveTab(tab));
          } else {
            setActiveTab(tab);
          }
        }}
        viewMode={viewMode}
      >
        {activeTab === "general" && (
          <ProjectInfoForm
            projectId={projectId}
            readOnly={readOnly}
          />
        )}
        {activeTab === "parts" && (
          <PartListTable
            projectId={projectId}
            readOnly={readOnly}
          />
        )}
        {activeTab === "org-chart" && (
          <OrgChartTree projectId={projectId} />
        )}
        {activeTab === "phases" && (
          <PhaseConfigTimeline
            projectId={projectId}
            readOnly={readOnly}
          />
        )}
        {activeTab === "roles" && (
          <RoleMatrixEditor
            projectId={projectId}
            readOnly={readOnly}
          />
        )}
        {activeTab === "workflow" && (
          <>
            <KanbanConfigForm
              projectId={projectId}
              readOnly={readOnly}
            />
            <SprintConfigForm
              projectId={projectId}
              readOnly={readOnly}
            />
          </>
        )}
        {activeTab === "notifications" && (
          <NotificationRuleList
            projectId={projectId}
            readOnly={readOnly && viewMode !== "PMO_CONTROL"}
          />
        )}
      </AdminTabLayout>
    </PageLayout>
  );
}
```

---

## 9. AI Navigation 연동

### 9.1 Admin 화면에서의 AI 추천 규칙

> Admin 화면은 `nodeRole: "action"`이므로 설정/변경 관련 질문에 +10 가산된다.
> 반면 일반 상태/현황 질문에는 Hub(dashboard) 등 다른 노드가 우선한다.

#### 9.1.1 AI 라우팅 정책

| 질문 | 추천 nodeId | deepLinkParams | 이유 |
|------|------------|---------------|------|
| "프로젝트 설정 보여줘" | `admin-project` | `{ tab: "general" }` | 직접 매칭 |
| "파트 추가하고 싶어" | `admin-project.parts` | - | virtualNode 우선 |
| "역할 권한 바꿔야 해" | `admin-project.roles` | - | virtualNode 우선 |
| "단계 일정 변경해줘" | `admin-project.phases` | - | virtualNode 우선 |
| "사용자 추가해야 해" | `admin-system.users` | - | virtualNode 우선 |
| "AI 서비스 상태 알려줘" | `admin-system.integrations` | - | virtualNode 우선 |
| "감사 로그 검색해줘" | `admin-system.audit-log` | `{ q: "{검색어}" }` | 검색어 전달 |
| "시스템 상태 확인" | `admin-system.health` | - | virtualNode 우선 |

#### 9.1.2 권한 부재 시 Fallback

```
사용자: "프로젝트 설정 보여줘" (DEV 역할)
→ requiredCaps: ["admin_project"] 미충족
→ AI 응답: "프로젝트 설정 화면에 접근 권한이 없습니다.
   프로젝트 관리자(PM)에게 문의해주세요."
→ CTA 비활성화 + 권한 부족 안내
→ secondary: 없음
```

### 9.2 AI Navigation Contract (Admin 전용)

```typescript
// Admin 화면의 AI 응답 예시
const aiAdminNavResponse: AiNavigationResponse = {
  answer: "프로젝트 설정 화면에서 Phase 일정을 조정할 수 있습니다.",
  navigation: {
    primary: {
      targetNodeId: "admin-project",
      deepLinkParams: { tab: "phases" },
    },
    secondary: {
      targetNodeId: "phases",
      deepLinkParams: {},
    },
  },
  viewMode: {
    suggested: "PM_WORK",
    reason: "설정 변경은 PM 권한 필요",
  },
  scopeHints: { projectId: "PRJ-001" },
};
```

---

## 10. 인터랙션 상세

### 10.1 탭 전환

```
탭 클릭
  → 미저장 변경 사항 확인
  → 있으면: UnsavedChangesDialog 표시
    → "저장 후 이동" / "저장 안 함" / "취소"
  → 없으면: 바로 탭 전환
  → URL query 갱신: ?tab={newTab}
  → 새 탭 데이터 로딩 (TanStack Query)
```

### 10.2 Part 행 클릭

```
Part 행 클릭
  → Right Panel 갱신 (Part Detail)
  → 팀원 목록 표시
  → 편집/삭제 버튼 표시 (PM_WORK만)
```

### 10.3 Phase 바 클릭

```
Phase Gantt 바 클릭
  → Right Panel 갱신 (Phase Detail)
  → 관련 Part, Task 수 표시
  → 편집/삭제 버튼 표시 (PM_WORK만)
```

### 10.4 Role Matrix 체크박스 토글

```
체크박스 토글
  → 로컬 상태 변경 (unsaved)
  → 상속된(inherited) 항목은 클릭 불가 (회색 + tooltip)
  → 변경 사항 카운트 표시: "3건 변경됨"
  → [저장] 클릭 시 PUT /role-matrix 호출
  → 성공 → Toast "역할-권한 매트릭스가 저장되었습니다"
  → 실패 → Toast 에러 + 롤백
```

### 10.5 사용자 생성

```
[+ 사용자 추가] 클릭
  → CreateUserDialog 표시
  → 필드 입력 + Validation
  → [생성] 클릭
  → POST /api/admin/system/users
  → 성공 → Dialog 닫기 + Table 새로고침 + Toast
  → 이메일 중복 → 인라인 에러 "이미 사용 중인 이메일입니다"
```

### 10.6 사용자 비활성화

```
[비활성화] 클릭
  → ConfirmDialog: "사용자를 비활성화하시겠습니까?"
  → "비활성화 시 모든 프로젝트 접근이 차단됩니다."
  → [확인] → POST /users/:userId/deactivate
  → 성공 → Table 상태 갱신 + Toast
```

### 10.7 연결 테스트

```
[연결 테스트] 클릭
  → 버튼 로딩 상태
  → POST /integrations/:serviceId/test
  → 성공 → [OK] 배지 + latency 표시
  → 실패 → [ERROR] 배지 + 에러 메시지
  → 3초 후 배지 자동 리셋
```

### 10.8 감사 로그 검색

```
검색어 입력 + [검색] 클릭 (또는 Enter)
  → GET /audit-logs?q={검색어}&dateFrom={}&dateTo={}
  → 결과 테이블 갱신
  → 행 클릭 → Right Panel에 상세 + 변경 Diff 표시
```

### 10.9 데이터 새로고침

| 항목 | 주기 |
|------|------|
| 프로젝트 설정 각 탭 | 탭 진입 시 fetch (staleTime: 5min) |
| 사용자 목록 | 페이지 진입 시 fetch (staleTime: 1min) |
| 시스템 헬스 | 30초 자동 갱신 |
| 통합 서비스 상태 | 1분 자동 갱신 |
| 감사 로그 | 검색 시 fetch (no cache) |
| 모델 성능 메트릭 | 30초 자동 갱신 (active model만) |

### 10.10 영향 분석 (Impact Preview) (v2.1)

```
[삭제] 또는 [비활성화] 클릭
  → GET /{resource}/{id}/impact API 호출
  → ImpactPreviewDialog 표시:
    - "이 Phase에 42건의 Task, 3건의 WBS가 연결되어 있습니다"
    - 자동 조치 옵션: "미할당 전환 (42건)" / "자식 Phase 비활성화 (2건)"
    - 확인 체크박스 2개: "영향 범위를 확인했습니다", "자동 조치에 동의합니다"
    - 체크박스 모두 선택해야 [확인] 버튼 활성화
  → [확인] → DELETE/POST 호출
  → 성공 → Toast + 목록 invalidate
  → 실패 → 에러 메시지 (409 = 이미 변경됨, 재시도 필요)
```

### 10.11 낙관적 잠금 충돌 해결 (v2.1)

```
[저장] 클릭 (PUT 요청 with version: N)
  → 서버가 현재 version과 비교
  → 일치 → 정상 저장 + version: N+1 반환
  → 불일치 → 409 Conflict + 서버 현재 값 반환
  → ConflictMergeDialog 표시:
    - 좌측: "내 변경 사항"
    - 우측: "다른 관리자의 최신 변경"
    - 차이점 하이라이트 (fieldPath 기준)
    - 옵션: "내 변경 덮어쓰기" / "최신 값 유지" / "취소"
  → "내 변경 덮어쓰기" → PUT with version: 현재서버version (force)
  → "최신 값 유지" → 폼을 서버 값으로 리셋
```

### 10.12 N회 연결 테스트 (v2.1)

```
[연결 테스트] 클릭
  → ConnectionNTestPanel 확장
  → POST /integrations/:serviceId/test-n { rounds: 5 }
  → 진행률 표시: "1/5 ... 5/5"
  → 결과: 평균 지연, 최대 지연, 오류율
  → 통과 (평균 < 500ms, 오류율 = 0) → [PASS] 배지 + [저장] 활성화
  → 실패 → [FAIL] 배지 + 원인 표시 + [저장] 비활성화
```

### 10.13 모델 핫스왑 (v2.1)

```
[핫스왑] 클릭
  → ModelHotSwapDialog 표시:
    - 현재 활성 모델: "Gemma-3-12B (L2)"
    - 대상 모델: "Gemma-3-12B-v2 (L2)"
    - "전환 중 기존 모델이 요청을 계속 처리합니다"
  → [시작] → POST /models/:modelId/hot-swap
  → 진행 상태: LOADING → ACTIVE (새 모델) / INACTIVE (기존 모델)
  → 완료 → Toast "모델 핫스왑 완료" + 모델 목록 invalidate
  → 실패 (로딩 에러) → 기존 모델 유지 + ERROR 상태 표시 + 에러 로그
```

---

## 11. 반응형 대응

### 11.1 브레이크포인트별 레이아웃

| 너비 | Tab Bar | Main Content | Right Panel |
|------|---------|-------------|-------------|
| >=1440px | 가로 탭 바 | 70% | 30% (visible) |
| 1280px | 가로 탭 바 (축약 라벨) | 100% | Drawer (toggle) |
| <=1024px | 드롭다운 탭 선택 | 100% | Drawer (overlay) |
| <=768px | 드롭다운 탭 선택 | 100% | Full Modal |

### 11.2 탭별 반응형 규칙

| 탭 | <=1024px 대응 |
|-----|-------------|
| 기본 정보 | 2열 → 1열 폼 |
| Sub-Part | 테이블 → 카드 리스트 |
| 조직도 | 트리 → 세로 스택 (수평 스크롤) |
| Phase | Gantt → 리스트 뷰 전환 |
| 역할-권한 | 매트릭스 → 수평 스크롤 + sticky 첫열 |
| 사용자 관리 | 테이블 → 카드 리스트 |
| 감사 로그 | 테이블 컬럼 축약 |
| 시스템 모니터링 | KPI 4열 → 2열 → 1열 |

---

## 12. 깨지기 쉬운 곳 체크리스트

### 12.1 역할-권한 매트릭스 동기화

> **위험**: RoleMatrixEditor에서 편집한 매핑이 백엔드 `computeCapabilities()`와 불일치
>
> **방어**:
> - 저장 시 서버 사이드 validation (허용 불가 조합 거부)
> - 저장 직후 현재 세션의 capability를 재계산 (`useCapabilities` invalidation)
> - "기본값 복원" 버튼으로 원래 상태로 롤백 가능

### 12.2 Phase 삭제 시 cascade 영향

> **위험**: Phase 삭제 시 연결된 Task, WBS, Sprint 등에 영향
>
> **방어**:
> - 삭제 전 영향 분석 표시: "이 Phase에 42건의 Task가 연결되어 있습니다"
> - `parent_id` self-FK의 자식 Phase도 함께 표시
> - 연결된 항목이 있으면 삭제 대신 "비활성화" 권장
> - 삭제 확인 다이얼로그에 영향 범위 명시

### 12.3 사용자 비활성화 시 프로젝트 영향

> **위험**: 비활성화된 사용자가 파트리더이거나 Task 담당자인 경우
>
> **방어**:
> - 비활성화 전 영향 분석: "이 사용자는 2개 프로젝트의 파트리더입니다"
> - 파트리더 재배정을 먼저 요구
> - 담당 Task는 미할당으로 전환 (별도 알림)

### 12.4 PMO 설정 필드 권한 혼선

> **위험**: PMO_CONTROL Preset에서 어디까지 편집 가능한지 혼선
>
> **방어**:
> - PMO 전용 필드(사업관리, 품질관리 등)만 편집 허용, 나머지 필드는 disabled + tooltip
> - 필드 레벨에서 `readOnly` prop 분기 (탭 레벨이 아닌 필드 레벨)

### 12.5 통합 서비스 설정 변경 시 런타임 영향

> **위험**: AI_SERVICE_URL 등 변경 시 즉시 반영되어 서비스 장애 가능
>
> **방어** (v2.1 강화):
> - N회 측정 테스트 필수 (5회 연속, 평균 < 500ms, 오류율 0%) — 통과 전 저장 차단
> - 설정 버전 3개 보관 + 1클릭 롤백
> - Change Freeze 모드: 장애 대응 중 모든 통합 설정 변경 차단 (ADMIN만 해제)
> - 적용 방식 선택: `immediate` / `on_next_restart`

### 12.6 다수 관리자 동시 편집 충돌 (v2.1)

> **위험**: PM과 PMO가 동시에 프로젝트 설정을 편집하면 마지막 저장이 이전 변경을 덮어씀
>
> **방어**:
> - 모든 리소스에 `version` 필드 (optimistic lock)
> - PUT 시 `version` 포함 필수 — 불일치 시 409 Conflict
> - ConflictMergeDialog로 "내 변경 vs 최신" diff 표시
> - 사용자가 "덮어쓰기" / "최신 유지" / "취소" 중 선택

### 12.7 감사 로그 경계 혼선 (v2.1)

> **위험**: 프로젝트 로그와 시스템 로그에 같은 이벤트가 중복 기록되거나, 어디에도 기록되지 않는 경우
>
> **방어**:
> - §6.6.0 경계 규칙을 서버 레벨에서 강제 (AuditLogInterceptor)
> - 프로젝트 범위 변경은 시스템 로그에 남기지 않음 (노이즈 감소)
> - 경계가 애매한 경우 (예: 사용자 비활성화가 프로젝트 파트리더에 영향) → 시스템 로그 1줄 + 프로젝트 로그 deep link

### 12.8 비밀정보(Secret) 처리 미비 (v2.1)

> **위험**: 통합 설정의 자격증명(비밀번호, 토큰)이 평문으로 저장/전송/로깅됨
>
> **방어**:
> - DB at-rest: AES-256 암호화 저장
> - API 응답: 항상 마스킹 (`"neo4j_password": "●●●●●●●●"`)
> - 변경 시: "비밀값 재입력 필요" 정책 — URL만 바꿀 때 비밀값은 빈칸 = "기존 유지"
> - 감사 로그: `sensitive: true` → old/new 값 모두 `"[REDACTED]"`
> - 프론트: 비밀 필드는 `type="password"` + 눈 아이콘 토글 (표시 시 3초 후 자동 숨김)

### 12.9 모델 핫스왑 중 서비스 품질 저하 (v2.1)

> **위험**: 새 모델 로딩 중 GPU 메모리 부족 또는 로딩 실패 시 L2 슬롯이 빈 상태
>
> **방어**:
> - 핫스왑은 "기존 모델 유지 + 새 모델 병렬 로딩" 패턴 (zero-downtime)
> - 새 모델 로딩 완료 후에야 기존 모델을 INACTIVE로 전환
> - 로딩 실패 시 기존 모델 그대로 유지 + ERROR 로그 + Toast 알림
> - GPU 메모리 사전 체크: `requiredGpuMemory > availableGpuMemory`이면 핫스왑 차단
> - 핫스왑 중 성능 메트릭 모니터링 강화 (5초 간격)

---

## 13. Capability 매핑

### 13.1 프로젝트 설정 Capability (v2.1 세분화)

> v2.1: `admin_project` + PM role 이중 체크를 제거하고, Capability만으로 선언적으로 통제한다.

| Capability | 용도 | 기본 부여 역할 |
|-----------|------|-------------|
| `admin_project_view` | 프로젝트 설정 메뉴 진입 + 전 탭 조회 | PM, PMO_HEAD |
| `admin_project_edit_general` | 기본 정보 탭 편집 (PMO 필드 포함) | PM, PMO_HEAD (PMO는 PMO 필드만) |
| `admin_project_manage_parts` | Part CRUD + 팀원 추가/제거 | PM |
| `admin_project_manage_phases` | Phase CRUD + 타임라인 편집 | PM |
| `admin_project_manage_role_matrix` | 역할-권한 매트릭스 편집 | PM |
| `admin_project_manage_workflow` | 칸반 WIP / Sprint 설정 편집 | PM |
| `admin_project_manage_notifications` | 알림 규칙 전체 편집 (PM) / 자기 알림만 (PMO) | PM, PMO_HEAD |

> **Capability → 기능 매핑 테이블**:

| 기능 | Capability | 탭 |
|------|-----------|-----|
| 프로젝트 설정 메뉴 진입 | `admin_project_view` | (전체) |
| 기본 정보 조회 | `admin_project_view` | general |
| 기본 정보 편집 | `admin_project_edit_general` | general |
| PMO 필드 편집 | `admin_project_edit_general` | general |
| Part 조회 | `admin_project_view` | parts |
| Part 추가/편집/삭제 | `admin_project_manage_parts` | parts |
| 조직도 조회 + Export | `admin_project_view` | org-chart |
| Phase 조회 | `admin_project_view` | phases |
| Phase 추가/편집/삭제 | `admin_project_manage_phases` | phases |
| Phase 삭제 영향 분석 | `admin_project_manage_phases` | phases |
| 역할-권한 매트릭스 조회 | `admin_project_view` | roles |
| 역할-권한 매트릭스 편집 | `admin_project_manage_role_matrix` | roles |
| 칸반/Sprint 조회 | `admin_project_view` | workflow |
| 칸반/Sprint 편집 | `admin_project_manage_workflow` | workflow |
| 알림 설정 조회 | `admin_project_view` | notifications |
| 알림 설정 편집 (전체) | `admin_project_manage_notifications` | notifications |
| 변경 이력 조회 | `admin_project_view` | (Right Panel) |

### 13.2 시스템 설정 Capability (v2.1 + 모델 관리)

| Capability | 용도 | 기본 부여 역할 |
|-----------|------|-------------|
| `admin_system` | 시스템 설정 메뉴 진입 + 전 탭 CRUD | ADMIN |
| `admin_models` | 모델 관리 탭 진입 + 모델 CRUD + 핫스왑 | ADMIN |

| 기능 | Capability | 탭 |
|------|-----------|-----|
| 시스템 설정 메뉴 진입 | `admin_system` | (전체) |
| 사용자 CRUD | `admin_system` | users |
| 사용자 비활성화 (영향 분석 포함) | `admin_system` | users |
| 시스템 역할 편집 | `admin_system` | roles |
| 조직 구조 편집 | `admin_system` | org-structure |
| 시스템 구성 편집 | `admin_system` | config |
| 통합 설정 조회 + N회 테스트 + 롤백 | `admin_system` | integrations |
| Change Freeze 토글 | `admin_system` | integrations |
| 감사 로그 조회 + Export | `admin_system` | audit-log |
| 시스템 모니터링 | `admin_system` | health |
| 백업/복원 (확인 코드 필수) | `admin_system` | health |
| 모델 등록/활성화/비활성화 | `admin_models` | models |
| 모델 핫스왑 | `admin_models` | models |
| 모델 성능 메트릭 조회 | `admin_models` | models |

### 13.3 Capability → Menu Visibility

```typescript
// menuConfig.ts (admin section) — v2.1 granular
{
  nodeId: "admin-project",
  route: "/admin/project",
  requiredCaps: ["admin_project_view"],  // v2.1: view cap for entry
  // Visible to: PM, PMO_HEAD
},
{
  nodeId: "admin-system",
  route: "/admin/system",
  requiredCaps: ["admin_system"],
  // Visible to: ADMIN only
},
```

### 13.4 Route Guard

```typescript
// routes.tsx — v2.1
<ProtectedRoute
  path="/admin/project"
  requiredCapabilities={["admin_project_view"]}
  component={ProjectAdminPage}
/>
<ProtectedRoute
  path="/admin/system"
  requiredCapabilities={["admin_system"]}
  component={SystemAdminPage}
/>
```

---

## 14. DoD (본 화면 완료 기준)

### 14.1 프로젝트 설정 (`/admin/project`)

- [ ] 7개 탭 구현 (기본정보, Sub-Part, 조직도, Phase, 역할-권한, 칸반/Sprint, 알림)
- [ ] 기본 정보 폼: 프로젝트 핵심 필드 편집 + PMO 설정 필드
- [ ] 확장 필드 저장소: `project_profiles` 테이블로 고객사/M·M/협력사/은장수 영속화 (v2.1)
- [ ] Sub-Part: Part CRUD + 팀원 관리 (추가/제거)
- [ ] 조직도: 수행PM -> 파트리더 -> 팀원 트리 시각화 + PNG/PDF Export + PMO 책임자 카드 (v2.1)
- [ ] Phase 설정: Phase CRUD + Gantt-like 타임라인 + AI/SI/COMMON 트랙 필터
- [ ] Phase hierarchy: `parent_id` self-FK 기반 부모-자식 Phase 표시
- [ ] Phase 삭제 시 ImpactPreviewDialog (v2.1)
- [ ] 역할-권한 매트릭스: RoleMatrixEditor + 상속 출처 표시 + Override 모드 (v2.1)
- [ ] 칸반/Sprint 설정: WIP 제한, Sprint 주기, SP 용량, 속도 기준 윈도우
- [ ] 알림 설정: 이벤트별 채널/수신자 설정
- [ ] Preset 분기: PM_WORK (full), PMO_CONTROL (read-only, PMO 필드만 편집)
- [ ] 탭 전환 시 미저장 변경 경고 (UnsavedChangesDialog)
- [ ] Right Panel: 변경 이력 표시 (ChangeHistoryPanel)
- [ ] 모든 설정 변경은 audit log 기록 (fieldPath 표준) (v2.1)
- [ ] 낙관적 잠금: 모든 PUT에 version 포함, 충돌 시 ConflictMergeDialog (v2.1)
- [ ] Capability 세분화: `admin_project_view` + 6종 편집 cap 기반 Route Guard (v2.1)

### 14.2 시스템 설정 (`/admin/system`)

- [ ] 8개 탭 구현 (사용자, 역할, 조직구조, 시스템구성, 통합설정, 감사로그, 모니터링, **모델관리**) (v2.1)
- [ ] 사용자 관리: CRUD + 비활성화/재활성화 + 비밀번호 초기화
- [ ] 사용자 비활성화 전 ImpactPreviewDialog (v2.1)
- [ ] 역할 관리: 시스템 역할 조회 및 기본 Capability 매핑
- [ ] 조직 구조: 부서 계층 편집
- [ ] 시스템 구성: 세션 타임아웃, 비밀번호 정책, JWT 설정, 업로드 제한
- [ ] 통합 설정: N회 측정 테스트 + 설정 버전 롤백 + Change Freeze (v2.1)
- [ ] 통합 설정: 비밀정보 암호화 저장 + 마스킹 응답 + 감사 로그 REDACTED (v2.1)
- [ ] 감사 로그: fieldPath 표준 + scope 경계 규칙 + 검색/필터/CSV Export (v2.1)
- [ ] 시스템 모니터링: CPU/Memory/Disk + 서비스 상태 + 백업 관리
- [ ] 백업/복원: Job 기반 비동기 + 확인 코드 입력 + 복원 전 자동 백업 (v2.1)
- [ ] 모델 관리: 등록/활성화/비활성화/핫스왑/삭제 + L1/L2 슬롯 + 성능 메트릭 (v2.1)
- [ ] 시스템 모니터링 30초 자동 갱신 / 모델 메트릭 30초 자동 갱신
- [ ] `admin_system` + `admin_models` Capability 기반 메뉴 노출 + Route Guard (v2.1)
- [ ] Preset: ADMIN_OPS (PMO_CONTROL에서 이름 변경) (v2.1)
- [ ] 모든 CRUD 작업에 ConfirmDialog / ImpactPreviewDialog 적용

### 14.3 공통

- [ ] 반응형 레이아웃 (>=1440 / 1280 / <=1024 / <=768)
- [ ] WCAG AA 접근성 (키보드 탐색, aria-label, 색상 대비)
- [ ] AI Navigation: admin-project, admin-system 2개 노드 + 각각 4~5개 virtualNode (v2.1: models)
- [ ] AI 추천 시 권한 없는 사용자에게 적절한 안내 메시지
- [ ] Action 노드 보너스: 설정/변경 질문에 +10 스코어 가산
- [ ] ImpactPreviewDialog 공통 컴포넌트 (Phase 삭제, 사용자 비활성화, RoleMatrix 변경) (v2.1)
- [ ] ConflictMergeDialog 공통 컴포넌트 (낙관적 잠금 충돌 해결) (v2.1)

### 14.4 테스트 전략 (v2.1)

#### 14.4.1 서버 단위 테스트 (Backend)

- [ ] Capability 기반 접근 제어: 7종 프로젝트 cap × 7탭 × 2역할(PM/PMO) 매트릭스 자동화
- [ ] 각 PUT 엔드포인트에 version 불일치 → 409 응답 검증
- [ ] ImpactAnalysis API: Phase(child+task)/Part(member)/User(leader+task) 각 케이스
- [ ] AuditLogInterceptor: scope 경계 규칙 — 프로젝트 변경이 시스템 로그에 기록되지 않는지 확인
- [ ] AuditChange.fieldPath 형식 검증 (dot-notation 패턴 regex)
- [ ] AuditChange.sensitive=true인 필드의 old/new 값이 "[REDACTED]"인지 확인
- [ ] IntegrationService: N회 테스트 결과 집계 + passThreshold 판정
- [ ] IntegrationService: Change Freeze 모드에서 PUT 차단 → 423 Locked
- [ ] RestoreJob: 확인 코드 불일치 → 403, 복원 전 자동 백업 생성 확인
- [ ] ModelAdminController: 핫스왑 시 기존 모델 유지 → 새 모델 ACTIVE 후 기존 INACTIVE 순서 확인
- [ ] ModelAdminController: GPU 메모리 초과 시 핫스왑 차단 → 409

#### 14.4.2 프론트엔드 테스트

- [ ] projectAdminTabs: PM_WORK에서 전 탭 `full`, PMO_CONTROL에서 `read-only` 스냅샷
- [ ] ConflictMergeDialog: 409 응답 시 표시 + "덮어쓰기"/"최신 유지" 분기
- [ ] ImpactPreviewDialog: 체크박스 미선택 시 확인 버튼 disabled
- [ ] ConnectionNTestPanel: 5/5 성공 시 PASS 배지 + 저장 활성
- [ ] ChangeFreezeBar: freeze 모드에서 통합 설정 모든 입력 disabled
- [ ] ModelHotSwapDialog: 진행 상태 표시 + 완료/실패 분기

#### 14.4.3 E2E 시나리오 (핵심 12)

| # | 시나리오 | 검증 포인트 |
|---|---------|-----------|
| 1 | PM이 Part 추가 → 멤버 추가 → Phase 수정 → RoleMatrix 저장 | 4탭 연속 CRUD, audit log 4건 |
| 2 | PMO가 general 탭에서 PMO 필드만 편집, 나머지 disabled 확인 | `admin_project_edit_general` 필드 레벨 분기 |
| 3 | DEV가 `/admin/project` 접근 → 403 리다이렉트 | Route Guard |
| 4 | ADMIN이 사용자 비활성화 → ImpactPreview(파트리더) → 확인 → 완료 | Impact + 비활성화 플로우 |
| 5 | 통합 설정 URL 변경 → N회 테스트 실패 → 저장 차단 | ConnectionNTest + 저장 gate |
| 6 | 통합 설정 URL 변경 → N회 테스트 성공 → 저장 → 롤백 | 설정 버전 + 롤백 |
| 7 | 감사 로그 검색 → 상세 diff → CSV export | fieldPath + export |
| 8 | PM + PMO 동시 편집 → version 충돌 → ConflictMergeDialog | Optimistic lock E2E |
| 9 | Phase 삭제 → ImpactPreview(task 42건) → 확인 체크 → 삭제 완료 | Impact + cascade |
| 10 | 모델 등록 → 활성화 → 핫스왑 → 기존 모델 INACTIVE 확인 | Model lifecycle |
| 11 | Change Freeze ON → 통합 설정 수정 불가 → Freeze OFF → 수정 가능 | Freeze toggle |
| 12 | 백업 복원 → 확인 코드 입력 → Job 진행률 → 완료 → 캐시 플러시 확인 | Restore safety |

#### 14.4.4 데이터 정합성 회귀 테스트

```
Phase 삭제 시나리오:
  Case 1: child phase 존재 → 삭제 거부(409) 또는 비활성화 유도
  Case 2: task 연결 존재 → ImpactPreview에 task 수 표시 + 미할당 전환 자동 조치
  Case 3: wbs 연결 존재 → ImpactPreview에 wbs 수 표시

사용자 비활성화 시나리오:
  Case 1: 파트리더인 경우 → 파트리더 재배정 필수 (비활성화 전 차단)
  Case 2: 담당 task가 있는 경우 → 미할당 전환 자동 조치 + 알림

RoleMatrix 변경 시나리오:
  Case 1: admin_project_view 제거 시 → 자기 자신에게서 제거 불가 (자기 잠금 방지)
  Case 2: 상속된 cap override → 저장 후 computeCapabilities 재계산 확인
```

---

## Appendix D. Changelog

### D.1 v2.0 → v2.1 변경 요약

| 항목 | 내용 |
|------|------|
| 버전 | v2.0 → v2.1 |
| 변경일 | 2026-02-08 |
| 변경 근거 | 크로스 리뷰 5개 영역 반영 + 모델 관리 기능 추가 |
| 주요 축 | (1) Capability 세분화, (2) Optimistic Lock, (3) Impact Preview |

### D.2 상세 변경 내역

#### Area 1 — 일관성 (Consistency)

| # | 섹션 | 변경 내용 |
|---|------|----------|
| 1 | §2.4, §4.2, §8.2 | 시스템 프리셋 `PMO_CONTROL` → `ADMIN_OPS` 일괄 변경 |
| 2 | §2.3, §5.5.1, §7.3, §8.2, §13 | `admin_project` 단일 cap → 7개 세분화 (`admin_project_view`, `_edit_general`, `_manage_parts`, `_manage_phases`, `_manage_role_matrix`, `_manage_workflow`, `_manage_notifications`) |
| 3 | §5.1.1a (신규) | 확장 필드 저장 설계 — `project_profiles` 테이블 DDL + 필드 매핑 테이블 |
| 4 | §6.6.0 (신규) | 감사 로그 경계 규칙 테이블 (project-scope / system-scope 분리 원칙) |
| 5 | §6.5.1a (신규) | 연동 안전 제어 — N-round 연결 테스트, 설정 버전 관리, Change Freeze 모드 |

#### Area 2 — UI/UX 개선

| # | 섹션 | 변경 내용 |
|---|------|----------|
| 6 | §1.2 | 9개 신규 설계 원칙 추가 (Capability 세분화, Optimistic Lock 등) |
| 7 | §5.5.1 | RoleCapabilityMapping에 `inheritedFrom`, `overridden` 필드 + RoleHierarchy 인터페이스 추가 |
| 8 | §10.10 (신규) | Impact Preview 인터랙션 플로우 (Phase 삭제, 사용자 비활성화, RoleMatrix 변경) |
| 9 | §10.11 (신규) | Optimistic Lock 충돌 해소 인터랙션 (ConflictMergeDialog) |
| 10 | §3.7 | 시스템 와이어프레임 탭 바에 '모델' 탭 추가 |

#### Area 3 — API / 데이터 설계

| # | 섹션 | 변경 내용 |
|---|------|----------|
| 11 | §7.1 | 프로젝트 API에 Impact 엔드포인트 추가 + PUT 요청 Optimistic Lock 주석 |
| 12 | §7.2 | 시스템 API에 모델 관리 9개 + 연동 안전 4개 + 복원 작업 1개 엔드포인트 추가 |
| 13 | §7.3 | 보안 어노테이션 전면 재작성 — capability 기반 인증 (`@RequiresCap`) |
| 14 | §6.6.1 | AuditLogEntry 확장 (scope, HOT_SWAP/RESTORE 액션, MODEL/BACKUP 대상) + fieldPath dot-notation 표준 |
| 15 | §6.7.1a (신규) | 백업/복원 안전 — RestoreJob (7-status), 확인 코드 입력, 사전 자동 백업, 복원 후 헬스체크 |

#### Area 4 — 테스트 전략

| # | 섹션 | 변경 내용 |
|---|------|----------|
| 16 | §14.1 | 서버 DoD 11개 항목 (capability 검증, optimistic lock, impact API 포함) |
| 17 | §14.2 | 프론트엔드 DoD 6개 항목 (ImpactPreviewDialog, ConflictMergeDialog 포함) |
| 18 | §14.3 | E2E 시나리오 12개 (Permission Matrix, Impact Preview, Model Hot-Swap 등) |
| 19 | §14.4 | 데이터 회귀 테스트 3개 그룹 (감사 로그, 백업/복원, RoleMatrix 상속) |

#### Area 5 — 모델 관리 (신규)

| # | 섹션 | 변경 내용 |
|---|------|----------|
| 20 | §1.3 | 모델 관리 질문→위젯 매핑 3개 추가 |
| 21 | §2.2 | AdminSystemFilterSpec에 models 탭 + modelId 필터 추가 |
| 22 | §2.4 | admin-system 노드에 모델 인텐트, 키워드, 메트릭, virtualNode 추가 |
| 23 | §3.11 (신규) | 모델 관리 와이어프레임 (레지스트리 테이블 + 성능 차트 + 상세 패널) |
| 24 | §6.8 (신규) | ModelRegistryEntry (L1/L2 슬롯, 5-status), ModelPerformanceMetrics, 상태 전이, CRUD API, 등록 폼 |
| 25 | §8.1 | 폴더 구조 — 모델 컴포넌트 6개, 공유 컴포넌트 4개, 훅 3개 추가 |
| 26 | §10.12 (신규) | N-round 연결 테스트 인터랙션 플로우 |
| 27 | §10.13 (신규) | 모델 Hot-Swap 인터랙션 플로우 (GPU 메모리 체크 → 사전 로드 → 교체) |
| 28 | §12.6–12.9 (신규) | Fragile 섹션 4개 (동시 편집, 감사 경계, 시크릿 처리, 모델 Hot-Swap) |
| 29 | §13 | Capability 매핑 전면 재작성 — 프로젝트 7개 + 시스템 2개 granular caps + 사용처 매핑 |
